{%extends "baselog.html"%}
{%block title%}Němčina{% endblock %}
{%block head%}
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/subject.css')}}">
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/subjects/germany.css')}}">

<!-- <script src="{{url_for('static',filename='jspdf/node_modules/jspdf/dist/jspdf.umd.min.js')}}"></script> -->
<script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
<script>const { jsPDF } = window.jspdf;</script>
<script src="{{url_for('static',filename='node_modules/dompurify/dist/purify.js')}}"></script>
<script src="{{url_for('static',filename='node_modules/html2canvas/dist/html2canvas.js')}}"></script>
<script src="{{url_for('static',filename='fonts/Calibri Regular-normal.js')}}"></script>
<script src="{{url_for('static',filename='fonts/Calibri Bold-bold.js')}}"></script>
<script src="{{url_for('static',filename='fonts/Cantarell-Regular-normal.js')}}"></script>
{%endblock%}
{%block content%}

<div id="MainDiv">
<div id="grid-container">
<div class="NAME"><b>Němčina</b></div>
<div class="grid-items first">
    <div class="scrollery">
        <div id="subclassinfo">
            <p>Progres: {{user.Nprogress}}</p>
            <div id="PVerb" onclick="visibilator('PVerb','','')" style="cursor:pointer;">
                Verb/Slovesa
            </div>
        </div>
    </div>
    {%if user.person=="t"%}
    <div id="CreateTest" onclick="visibilator('CreateTest')">
        <b>Vytvořit test</b>
    </div>
    {%endif%}
    <div class="bsetings">
        <input type="checkbox" id="chvilkanakontrolu"> <label for="chvilkanakontrolu">dodatečný čas po odpovědi</label>
    </div>
</div>
<div class="grid-items second">
    <p id="WS"><b>Wortschatz</b></p>
    <div id="gisscroller">
        <div class="Module" id="M1" tabindex="1" value="50" value2="330" style="background-color: rgb(139, 68, 194);">
            <p class="TitleWS"><b>1) Deutsch ist NICHT leicht!</b></p>
            <div class="child">
                {%for i,v in NJW["module1"].items()%}
                <div class="L" onclick="visibilator('{{i}}','1','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>                
        </div>
        <div class="Module" id="M2" tabindex="1" value="50" value2="200" style="background-color: orange;">
            <p class="TitleWS"><b>2) Hobbys und Schule</b></p>
            <div class="child">
                {%for i,v in NJW["module2"].items()%}
                <div class="L" onclick="visibilator('{{i}}','2','w')">
                    {{i}} ({{v[0]}})
                </div>
                {%endfor%}
            </div> 
        </div>
        <div class="Module" id="M3" tabindex="1" value="50" value2="200" style="background-color: rgb(185, 40, 125);">
            <p class="TitleWS"><b>3) Freizeit und Feiern</b></p>
            <div class="child">
                {%for i,v in NJW["module3"].items()%}
                <div class="L" onclick="visibilator('{{i}}','3','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M4" tabindex="1" value="70" value2="200" style="background-color: rgb(18, 173, 70);height:4rem;">
            <p class="TitleWS"><b>4) Essen, Einkaufen und Gesundheit</b></p>
            <div class="child">
                {%for i,v in NJW["module4"].items()%}
                <div class="L" onclick="visibilator('{{i}}','4','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M5" tabindex="1" value="50" value2="200" style="background-color: rgb(70, 111, 199);">
            <p class="TitleWS"><b>5) Zu Hause und auf Reisen</b></p>
            <div class="child">
                {%for i,v in NJW["module5"].items()%}
                <div class="L" onclick="visibilator('{{i}}','5','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M6" tabindex="1" value="50" value2="200" style="background-color: rgb(101 76 251);">
            <p class="TitleWS"><b>6) Arbeit und Freizeit</b></p>
            <div class="child">
                {%for i,v in NJW["module6"].items()%}
                <div class="L" onclick="visibilator('{{i}}','6','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M7" tabindex="1" value="50" value2="200" style="background-color: rgb(255 129 12);">
            <p class="TitleWS"><b>7) Menschen und Gesundheit</b></p>
            <div class="child">
                {%for i,v in NJW["module7"].items()%}
                <div class="L" onclick="visibilator('{{i}}','7','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M8" tabindex="1" value="50" value2="200" style="background-color: rgb(20, 100, 37);">
            <p class="TitleWS"><b>8) Schule und Berufe</b></p>
            <div class="child">
                {%for i,v in NJW["module8"].items()%}
                <div class="L" onclick="visibilator('{{i}}','8','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M9" tabindex="1" value="50" value2="175" style="background-color: rgb(42 145 241);">
            <p class="TitleWS"><b>9) Medien und Freizeit</b></p>
            <div class="child">
                {%for i,v in NJW["module9"].items()%}
                <div class="L" onclick="visibilator('{{i}}','9','w')">
                    {{i}}
                    ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
        <div class="Module" id="M10" tabindex="1" value="50" value2="200" style="background-color: rgb(108 160 37);">
            <p class="TitleWS"><b>10) Natur und Umwelt</b></p>
            <div class="child">
                {%for i,v in NJW["module10"].items()%}
                <div class="L" onclick="visibilator('{{i}}','10','w')">
                    {{i}} ({{v[0]}})
                </div>
                {%endfor%}
            </div>
        </div>
    </div>
</div>
<div class="grid-items third">
    <div id="G"><b>Grammatik</b></div><div></div>
    <div id="temata">
        <div id="G1">1.Podstatná jména</div>
        <div id="G2">2.Přídavná jména</div>
        <div id="G3">3.Zájmena</div>
        <div id="G4">4.Slovesa</div>
        <div id="G5">5.Předložky</div>
        <div id="G6">6.Spojky</div>
    </div>
    <div id="GO">
        <div class="GO GO1">
            <p class="GON">Podstatná jména (Nomen)</p>
            <div>Silné skloňování</div>
            <div>Slabé skloňování</div>
            <div>Skloňování mix</div>
            <div>Člen určitý</div>
            <div>Člen neurčitý</div>
            <div>Beze Členu</div>
            <div>Členy mix</div>
        </div>
        <div class="GO GO2">
            <p class="GON">Přídavná jména (Adjektive)</p>
            <div>Skloňování s určitým členem</div>
            <div>Skloňování s neurčitým členem</div>
            <div>Skloňování bez členu</div>
            <div>Skloňování mix</div>
            <div>Stupňování</div>
        </div>
        <div class="GO GO3">
            <p class="GON">Zájmena (Pronomen)</p>
            <div>Osobní zájmena</div>
            <div>Zvratná zájmena</div>
            <div>Ukazovací zájmena</div>
            <div>Přivlasťnovací zájmena</div>
        </div>
        <div class="GO GO4">
            <p class="GON">Slovesa (Verben)</p>
            <div onclick="visibilator('VerbenInPräsens')">Slovesa v přítomném čase</div>
            <div>Slovesa v Perfektu</div>
            <div>Slovesa v Préteritu</div>
            <div>Způsobová slovesa</div>
            <div>Rozkazovací způsob</div>
            <div>Slovesná rekce</div>
            <div>Konjuktiv II.</div>
        </div>
        <div class="GO GO5">
            <p class="GON">Předložky (Präpositionen)</p>
            <div>Předložky se 3. pádem</div>
            <div>Předložky se 4. pádem</div>
            <div>Předložky mix</div>
        </div>
        <div class="GO GO6">
            <p class="GON">Spojky (Konjuktionen)</p>
            <div>Spojky souřadicí</div>
            <div>Spojky podřadicí</div>
            <div>Spojky mix</div>
        </div>
    </div>
</div>
</div>
<!------------------------------------------------------------------------------------------------------------>
<div id="clickDisabler">
<div id="TestDiv">
    <div class="krizek" onclick="hider()" tabindex=3 style="z-index: 2;">✕</div>
    <div id="TDContent">
        <div id="CreateTestDIV">
            <div class="nzadani"><b>Zde můžeš vytvořit vlastní test</b></div>
          
            <div id="CTGW">
                <div id="Grammatikk" style="background-color: rgb(55,55,55);color:white;">Gramatika</div>
                <div id="Wortschatzz">Slovní zásoba</div>
                <div id="filters">
                    <div id="FG">
                        Slovní druhy
                        <select id="SlDChoose">
                            <option value="none"></option>
                            <option value="Podstatná jména">Podstatná jména</option>
                            <option value="Přídavná jména">Přídavná jména</option>
                            <option value="Zájmena">Zájmena</option>
                            <option value="Slovesa">Slovesa</option>
                            <option value="Předložky">Předložky</option>
                            <option value="Spojky">Spojky</option>
                        </select>
                    </div>
                    <div id="FW" style="display:none">
                        Module
                        <select id="ModuleChoose">
                            <option value="none"></option>
                            <option value="1">Module 1</option>
                            <option value="2">Module 2</option>
                            <option value="3">Module 3</option>
                            <option value="4">Module 4</option>
                            <option value="5">Module 5</option>
                        </select>
                    </div>
                </div>
                <div style="grid-column:1/3;width:99%;">
                    <table class="ListOfMaterials" id="LGT">
                        <thead>
                            <tr>
                                <th style="width:150px"><div class="LOFMColor">Slovní druh</div></th>
                                <th style="width:350px"><div class="LOFMColor">Název</div></th>
                            </tr>
                        </thead>
                        <tbody id="LG">
                        </tbody>
                    </table>
                    <table class="ListOfMaterials" id="LWT">
                        <thead>
                            <tr>
                                <th style="width:150px"><div class="LOFMColor">Module</div></th>
                                <th style="width:350px"><div class="LOFMColor">Název</div></th>
                            </tr>
                        </thead>
                        <tbody id="LW">
    
                        </tbody>
                    </table>
                </div>
            </div>      
            <div id="newTask" onclick="addTask()">Přidat</div>
            <div id="showTest" onclick="showTest()">Náhled</div>
            <div id="showSavedTests" onclick="showSavedTests()">Uložené testy</div>
            <div id="canvas" class="canvas">
                <div id="RemovePage" class="CantHover" onclick="DoSmWithPage('R')">-</div>
                <div id="LeftButton" class="CantHover" onclick="changePage('left')">&lt</div>
                <div id="PageNumber">1</div>
                <div id="RightButton" class="CantHover" onclick="changePage('right')">&gt</div>
                <div id="AddPage" class="CanHover" onclick="DoSmWithPage('A')">+</div>
                <div class="list"id="firstPage">
                    <div id="zahlavi">
                        <b><div id="nameOfTest" contenteditable="true" spellcheck="false">Test</div></b>
                        <div id="studentName" contenteditable="true" spellcheck="false">jméno: </div>
                        <div id="className" contenteditable="true" spellcheck="false">třída: </div>
                        <div id="datumName" contenteditable="true" spellcheck="false">datum: </div>
                        <hr style="position:absolute;top:100px;width:calc(100% - 50px);">
                    </div>
                    <div class="content" style="height:calc(100% - 94px);margin-top:10px;">
                    </div>
                </div>
            </div>
        </div>   
        <div id="progression">
            <div id="fill">
                <div class="border" style="left:25%"></div>
                <div class="border" style="left:50%"></div>
                <div class="border" style="left:75%"></div>
            </div>
        </div>
        <div id="numberofTests">
            
        </div>
        <div class="task ABCD">
            <div class="answer">
                <p id="FrantaABCD" class="Franta"></p>
                <div class="centralizer" style="bottom:70px;">
                    <div id="ABCDodpovedi">
                        <div style="border:solid 3px rgb(189, 213, 234)" type="button" class="Felix" id="A" onclick="checkanswer('A')">Odpoved A</div>
                        <div style="border:solid 3px rgb(189, 213, 234)" type="button" class="Felix" id="B" onclick="checkanswer('B')">Odpoved B</div>
                        <div style="border:solid 3px rgb(189, 213, 234)" type="button" class="Felix" id="C" onclick="checkanswer('C')">Odpoved C</div>
                        <div style="border:solid 3px rgb(189, 213, 234)" type="button" class="Felix" id="D" onclick="checkanswer('D')">Odpoved D</div>
                        
                    </div>
                </div>
            </div>
        </div>
        <div class="task TextInput">
            <div class="answer"> 
                <div class="centralizer" style="top:-90px">
                    <p id="nw"></p>
                </div>       
                <p id="FrantaX" class="Franta"></p>
                
                <div class="centralizer" style="bottom: 170px;">
                    <div style="display:flex;">
                        <div id="XPA">
                            <input type="text" id="TextInputArtikel" spellcheck="false" maxlength="3">
                        </div>
                        <div id="XP">
                            <input type="text" id="TextInput" spellcheck="false">
                        </div>
                    </div>
                        <div id="SubstituteForInput">

                        </div>
                </div>
                <div class="centralizer" style="bottom: 70px;">
                        <div type="button" onclick="checkanswer('TextInput')" id="kontrola" style="margin-top:50px;">Kontroll</div>
                </div>
                <div id="QuestionMark">
                    ?<div id="TextInputHelp">&nbspU&nbsppodstatných&nbspjmen&nbspzadávej&nbsppouze&nbspčlen&nbspa&nbspjednotné&nbspčíslo.</div>
                </div>
                
            </div>

        </div>
        <div class="task FLASHCARDS">
            <p id="flashinfo"></p>
            <div id="table"class="centralizer">
                <div class="centralizer balicek repete"id="vyber" style="z-index:3;background-image: url(/static/images/repete.png)">
                    <div class="decks" id="VYBER"></div>
                </div>
                <div class="balicek" id="spatny" ><div class="decks" id="SPATNY"></div></div>
                <div class="balicek" id="dobry"><div class="decks" id="DOBRY"></div></div>
                
                <!--Jak vypadá karta
                    <div class="karta" draggable="true" >
                        <div class="textcentralizer">
                            <div class="front">
                                <p class="KartaText">das Deutsch</p>
                            </div>
                            <div class="back">
                                <p class="KartaText">němčina</p>
                            </div>
                        </div>
                    </div> 
                -->
            </div>
            <div id="bspopis"><b>wiederholen</b></div>
            <div id="bdpopis"><b>verstanden</b></div>
            <div id="vyhodnoceni"class=centralizer></div>
        </div>
        <div class="task Pexeso">
            <div class="pexeso">
                <div id="npexeso">
                    <div id="np0" ></div>
                    <div id="np1" ></div>
                    <div id="np2" ></div>
                    <div id="np3" ></div>
                    <div id="np4" ></div>
                    <div id="np5" ></div>
                    <div id="np6" ></div>
                    <div id="np7" ></div>
                    <div id="np8" ></div>
                    <div id="np9" ></div>
                </div>
                <div id="czpexeso">
                    <div id="czp0" ></div>
                    <div id="czp1" ></div>
                    <div id="czp2" ></div>
                    <div id="czp3" ></div>
                    <div id="czp4" ></div>
                    <div id="czp5" ></div>
                    <div id="czp6" ></div>
                    <div id="czp7" ></div>
                    <div id="czp8" ></div>
                    <div id="czp9" ></div>
                </div>
            </div>
        </div>
        <div class="congratulation">
            <div style="display:flex;flex-direction:column;justify-content:center;align-items: center;position: absolute;width: 100%;height: 100%;">
                <p style="font-size: 42px;"><b>Gratulation zum Bestehen der Prüfung</b></p>
                <p style="font-size:30px;">Gratuluji k dokončení testu:</p><br>
                <p style="font-size: 100px;"id="procenta"></p>
            </div>
        </div>
        <div class="Teorie xPVerb">
            <table>
                <tr>
                    <th>id</th>
                    <th>slovíčko</th>
                </tr>
                <tr><td>1</td><td>haben</td></tr>
                <tr><td>[cislo]</td><td>[sloveso]</td></tr>
            </table>
        </div>
        <div class="Teorie xs">
            <b><div id="strana"></div></b>
            <div class="sgrid">
                <div id="slovicka">
                    <table id='tabulka'>
                        <tr><th style="width:30px">id</th><th style="width:230px"><div style="cursor:pointer" onclick="LanguageWordsHider(document.getElementById('GermanWH'))">německy</div></th><th><div style="cursor:pointer" onclick="LanguageWordsHider(document.getElementById('CzechWH'))">česky</div></th></tr>
                        <tr><td colspan=3 >
                            <div id="scroll">
                                <table id="slovnicek">

                                </table>
                            </div>
                        </td></tr>
                    </table>
                    <div id="GermanWH"style="display:none; left:25px"></div>
                    <div id="CzechWH" style="display:none; left:238px"></div>
                </div>
                <div class="Wgridchild Flashcards" onclick="teststart('FlashCards')">
                    Lernkarten
                </div>
                <div class="Wgridchild WritingCZ" onclick="teststart('NtoCZ')">
                    Psaní<br>
                    němčina<br>
                    ↓<br>
                    čeština
                </div>
                <div class="Wgridchild WritingN" onclick="teststart('CZtoN')">
                    Psaní<br>
                    čeština<br>
                    ↓<br>
                    němčina
                </div>
                <div class="Wgridchild Matches" onclick="teststart('Pexeso','W')">
                    Verbinden
                </div>
            </div>
        </div>
        <div class="Teorie Unbestimmte_und_bestimmte_Artikel">
            <p class="nnadpis"><b>Unbestimmte und bestimmte Artikel</b></p>
            <p class="cnadpis">Neurčité a určité členy</p>
            <div class="g">
                <table id="UuBAtable">
                    <tr>
                        <th></th>
                        <th colspan="3">jednotné číslo (sg)</th>
                        <th>množné číslo (pl)</th>
                    </tr>
                    <tr>
                        <th></th>
                        <td class="m" style="background-color:rgb(97, 97, 231);">rod mužský (m)</td>
                        <td class="f" style="background-color:rgb(194, 92, 92);">rod ženský (ž)</td>
                        <td class="n" style="background-color:rgb(110, 177, 127);">rod střední (s)</td>
                        <td class="a" style="background-color:rgb(228, 213, 76);">všechny rody</td>
                    </tr>
                    <tr>
                        <td style="background-color:rgb(77, 135, 223)"><b>Das ist/sind ...</b></td>
                        <td><span>ein</span> Ring</td>
                        <td><span>eine</span> Jacke</td>
                        <td><span>ein</span> T-Shirt</td>
                        <td>Schuhe</td>
                    </tr>
                    <tr>
                        <td style="background-color:rgb(77, 135, 223)"><b>Was kostet/kosten ...?</b></td>
                        <td><span>der</span> Ring</td>
                        <td><span>die</span> Jacke</td>
                        <td><span>das</span> T-Shirt</td>
                        <td><span>die</span> Schuhe</td>
                    </tr>

                </table>
            </div>
            <ul class="additionalText">
                <li>Mluvíme-li o nějaké věci <u>poprvé</u>, používáme člen <b>neurčitý</b>.</li>
                <li>Jestliže na něco <u>ukazujeme nebo odkazujeme</u> na něco, o čem už byla řeč, používáme člen <b>určitý</b>.</li>
                <li>Členy různých podstatných jmen se budeš učit, postupem času. Zde je jenom pro ukázku pár příkladů.</li>
            </ul>
            <div class="cara"></div>
            <div class="b">
                <p class="ntext"><b>Übungen:</b></p>
                <p class="ctext">Cvičení:</p>
                <div class="t easyt" onclick="teststart('ABCD','1-3','Grammatik','2')">leichter Test</div>
                <div class="t hardt" onclick="teststart('TextInput','1-3','Grammatik','2')">schwieriger Test</div>
            </div>
        

        </div>
        <div class="Teorie VerbenInPräsens">
            <p class="nnadpis"><b>Verben in Präsens</b></p>
            <p class="cnadpis">Slovesa v přítomném čase</p>
            <div id="VIPT">
                <div class="tblock">
                    <div class="tnadpis">Slovesa I.</div>
                    <div class="t" onclick="teststart('ABCD','Slovesa v přítomném čase I.','','Slovesa')">
                    <img src="{{url_for('static',filename='images/ABCD.png')}}"><br>Rozhodovačka</div>
                </div>
                <div class="tblock">
                    <div class="tnadpis">Slovesa II.</div>
                    <div class="t" onclick="teststart('ABCD','Slovesa v přítomném čase II.','','Slovesa')">
                    <img src="{{url_for('static',filename='images/ABCD.png')}}"><br>Rozhodovačka</div>
                </div>
                <div class="tblock">
                    <div class="tnadpis">Slovesa III.</div>
                    <div class="t" onclick="teststart('ABCD','Slovesa v přítomném čase III.','','Slovesa')">
                    <img src="{{url_for('static',filename='images/ABCD.png')}}"><br>Rozhodovačka</div>
                </div>
                <div id="HundertVerb">
                    <div class="tnadpis" style="position:absolute;transform: translate(-50%,0%);left:50%;top:0%;">100 nejčastějších sloves</div>
                    <div class="t" onclick="teststart('TextInput','100 nejčastějších sloves','CZ','Slovesa')">
                    <img src="{{url_for('static',filename='images/TranslateToCZ.png')}}"><br>Překlad</div>
                    <div class="t" onclick="teststart('TextInput','100 nejčastějších sloves','N','Slovesa')">
                    <img src="{{url_for('static',filename='images/TranslateToN.png')}}"><br>Překlad</div>
                    <div class="t" onclick="teststart('Pexeso','100 nejčastějších sloves','','Slovesa')">
                    <img src="{{url_for('static',filename='images/Pexeso.png')}}"><br>Pexeso</div>
                </div>
            </div>
            <div class="testy">
                
            </div>
        </div>
    </div>
</div>
</div>
<div id="clickDisabler2">
    <div id="Former">
        <div class="Platno">
            <div id="ZP">
                <b><div id="TN" contenteditable="true" spellcheck="false">Test</div></b>
                <div id="SN" contenteditable="true" spellcheck="false">jméno: </div>
                <div id="CN" contenteditable="true" spellcheck="false">třída: </div>
                <div id="DN" contenteditable="true" spellcheck="false">datum: </div>
                <hr style="position:absolute;top:100px;width:calc(100% - 50px);">
            </div>
        </div>
    </div>
    <div id="buttonsPDF">
        <div id="randomPDF"  onclick="randomPDF()">
            <svg width="32px" height="32px" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#000" d="M255.76 44.764c-6.176 0-12.353 1.384-17.137 4.152L85.87 137.276c-9.57 5.536-9.57 14.29 0 19.826l152.753 88.36c9.57 5.536 24.703 5.536 34.272 0l152.753-88.36c9.57-5.535 9.57-14.29 0-19.825l-152.753-88.36c-4.785-2.77-10.96-4.153-17.135-4.153zm.926 82.855a31.953 18.96 0 0 1 22.127 32.362 31.953 18.96 0 1 1-45.188-26.812 31.953 18.96 0 0 1 23.06-5.55zM75.67 173.84c-5.753-.155-9.664 4.336-9.664 12.28v157.696c0 11.052 7.57 24.163 17.14 29.69l146.93 84.848c9.57 5.526 17.14 1.156 17.14-9.895V290.76c0-11.052-7.57-24.16-17.14-29.688l-146.93-84.847c-2.69-1.555-5.225-2.327-7.476-2.387zm360.773.002c-2.25.06-4.783.83-7.474 2.385l-146.935 84.847c-9.57 5.527-17.14 18.638-17.14 29.69v157.7c0 11.05 7.57 15.418 17.14 9.89L428.97 373.51c9.57-5.527 17.137-18.636 17.137-29.688v-157.7c0-7.942-3.91-12.432-9.664-12.278zM89.297 195.77a31.236 18.008 58.094 0 1 33.818 41.183 31.236 18.008 58.094 1 1-45-25.98 31.236 18.008 58.094 0 1 11.182-15.203zm221.52 64.664A18.008 31.236 31.906 0 1 322 275.637a18.008 31.236 31.906 0 1-45 25.98 18.008 31.236 31.906 0 1 33.818-41.183zM145.296 289.1a31.236 18.008 58.094 0 1 33.818 41.183 31.236 18.008 58.094 0 1-45-25.98 31.236 18.008 58.094 0 1 11.182-15.203zm277.523 29.38A18.008 31.236 31.906 0 1 434 333.684a18.008 31.236 31.906 0 1-45 25.98 18.008 31.236 31.906 0 1 33.818-41.184zm-221.52 64.663a31.236 18.008 58.094 0 1 33.817 41.183 31.236 18.008 58.094 1 1-45-25.98 31.236 18.008 58.094 0 1 11.182-15.203z"/></svg>
        </div>
        <div id="savePDF"  onclick="savePDF()">Uložit</div>
        <div id="downloadPDF" onclick="downloadPDF()">Stáhnout</div>
        <div id="exitPDF" style="background-color:#E71212" onclick="exitPDF()">Zrušit</div>
    </div>
</div>
<div id="preparedTest">
    <div id="tests">
        {%for i in user.tests%}
        <div class="PT" id="tlacitko-{{i.id}}" onclick="showPT('{{i.id}}')">
            {{i.name}}
        </div>
        {%endfor%}
    </div>
    <div id="pTCanvas">
        {%for i in user.tests%}
        <div class="PTest" id="{{i.id}}">
            <script>
                x="{{i.data}}".split(";");
                textToAdd="";
                for(let i=0;i<x.length;i++){
                    textToAdd+=`<div class='PTukol'><p class="PTzadani"><b>${x[i].split("$")[0]}</b></p>`
                    for(let y=1;y<x[i].split("$").length;y++){
                        textToAdd+=`<p>${x[i].split("$")[y].split(":")[0]}</p>`;
                    }
                    textToAdd+="</div>"
                }
                document.getElementById("{{i.id}}").innerHTML=textToAdd;
            </script>
        </div>
        {%endfor%}
    </div>
    <div id="buttonsSPT">
        <div id="deleteSPT" style="opacity:0.5">Smazat</div>
        <div id="exitSPT" style="background-color:#E71212" onclick="exitSPT()">Zrušit</div>
    </div>
</div>
<div id="areYouSure">
    Chcete smazat tento test?
        <div id="aYSD" onclick="deleteSPT()">Smazat</div>
        <div id="aYSC" onclick="document.getElementById('areYouSure').style.display='none'">Zrušit</div>
</div>
</div>
<div id="flashedmsg">
    <div style="width:260px">
    {%with messages = get_flashed_messages(with_categories=true)%}
        {% if messages %}
            {%for msg in messages %}
                <p>{{msg[1]}}</p>
            {%endfor%}
        {% endif %}
    {%endwith%}
    </div>
    <div id="exit" onclick="document.getElementById('flashedmsg').style.display='none'">✕</div>
</div>
<script>
    function sleep(ms){return new Promise(resolve => setTimeout(resolve,ms))};
    async function LanguageWordsHider(G){
        if(G.style.display=='none'){
            G.style.display="block";
            G.style.backdropFilter="blur(3px)";
        }
        else{
            G.style.backdropFilter="blur(0px)";
            await sleep(300);
            G.style.display="none";
        }
    }
    //vše týkající se zviditelňování
    $(document).ready(function(){
        const child = document.querySelectorAll(".child"); 
        const x = document.querySelectorAll(".Module");
        const a = [false,false,false,false,false,false,false,false,false,false]
        for(let i=1;i<11;i++){
            $("#M"+i).click(function(){
                if (!(a[i-1])){
                    for (let y=0;y<10;y++){
                        a[y]=false;
                        child[y].style.display="none";
                        x[y].style.height=x[y].getAttribute("value")+"px";
                    };
                    a[i-1]=true;
                    x[i-1].style.height=x[i-1].getAttribute("value2")+"px";
                    child[i-1].style.display="block";
                }        
            });
        };
        for(let i=1;i<7;i++){
            $("#G"+i).click(function(){
                for(let y=1;y<7;y++){
                    document.getElementsByClassName("GO"+y)[0].style.display="none";
                    document.getElementById("G"+y).style.backgroundColor="var(--blue)";
                }
                document.getElementsByClassName("GO"+i)[0].style.display="block";
                this.style.backgroundColor="rgb(121 148 185)";
            })
        }
        $("#TDContent").children().hide();     
        if (document.getElementById("flashedmsg").innerText.length>41){
            document.getElementById("flashedmsg").style.display="block"
        }
    });
</script>
<!-- kostra projektu -->
<script>
    // Vše týkající se testů 
    //kdybych se někdy divil proč jsem místo dict rozložil slovíčka na 2 array
    //je to z toho důvodu že přes internet dict přichází 
    //ROZHÁZENÉ a já nevím jak to :D
    const NJW = JSON.parse('{{ NJW | tojson | safe }}');
    const NJG = JSON.parse('{{ NJG | tojson | safe }}')
    const zakladnibarva = "3px solid rgb(189, 213, 234)";
    const spravnabarva = "rgb(25, 146, 61)";
    const spatnabarva = "rgb(199, 42, 42)";
    const oznacovacibarva = "3px solid rgb(87, 115, 153)";
    let kontrola,MomentalFillWidth,UnusedQuestions,MomentalQuestion,Into,Penalty,Boost,TypeOfTest,NameOfTest,SetOfQuestions,Success,NumberOfPossibleAnswers,NumberForCalculationOfSuccess,ABCDanswer,CurrentVocabulary,ant,derdiedas;
    let CanUseEnter=false,CanUseEsc=false,CanUseArrows=false;
    let WordsInVocabulary=[],OrderOfWords =[];
    const substituteForInput=document.getElementById("SubstituteForInput");
    const TextInput = document.getElementById("TextInput");
    const TextInputArtikel = document.getElementById("TextInputArtikel");
    const BorderForTextInput = document.getElementById("XP"); 
    const BorderForTextInputArtikel = document.getElementById("XPA");
    const nw = document.getElementById("nw");
    const NumberOfTests = document.getElementById("numberofTests");
    let dvapokusy,TenWords,WhichBox;
    let z=0;
    let draggedItem = null;
    const config = { attributes: true, childList: true, characterData: true };
    let Nchoosed,CZchoosed;
    
    function show(a){
        x=document.getElementsByClassName(a);
        for(let i=0;i<x.length;i++){

            x[i].style.backgroundColor="rgb(168, 168, 168)";
            x[i].style.borderRadius="2px";
        }
    }
    function hide(a){
        x=document.getElementsByClassName(a);
        for(let i=0;i<x.length;i++){
            x[i].style.backgroundColor="";
            x[i].style.borderRadius="";
        }
    }
    //ABCD hover mod
    function ABCDhover(){
        for (let i=0;i<NumberOfPossibleAnswers;i++){
            ABCDanswer[i].addEventListener("mouseover",function (event){
                if (event.target.style.border==zakladnibarva) {
                    event.target.style.border=oznacovacibarva;                
                }
            })
            ABCDanswer[i].addEventListener("mouseleave",function (event){
                if (event.target.style.border==oznacovacibarva) {
                    event.target.style.border=zakladnibarva;
                }
            })
        }
    }
//---------------------------------------------------------------------------
//Obecné funkce pro otázky, ...
    //zobrazuje okno pro teorie, texty, otázky, ...
    function visibilator(ukol,module,typ){
        CanUseEsc=true;
        $("#clickDisabler").show();
        if (ukol=="CreateTest"){
            document.getElementById("CreateTestDIV").style.display="block";
        }
        else{
            NameOfTest=ukol.replace(/ /g,"_");
            if (typ=="w"){
                document.getElementById("slovnicek").innerText="";
                CurrentVocabulary=NJW["module"+module][ukol];
                slovicka=""
                for(let i=0;i<CurrentVocabulary[0];i++){
                    slovicka+="<tr><td>"+(i+1)+"</td><td>"+CurrentVocabulary[3][i]+"</td><td>"+CurrentVocabulary[1][i]+"</td><td>"+CurrentVocabulary[2][i]+"</td></tr>";
                };
                document.getElementById("slovnicek").innerHTML+=slovicka;
                document.getElementById("strana").innerHTML=ukol;
                $(".xs").show();
            }
            else{
                if(NameOfTest.slice(-1)=="."){
                    $("."+NameOfTest.slice(0,-1)).show();
                }
                else{
                    $("."+NameOfTest).show();
                }
            }
        }
    };
    // schovává okno pro teorie, texty, otázky, ...
    function hider(){
        $("#clickDisabler").hide();
        $("#TDContent").children().hide();
        $(".task").hide();
        $(".congratulation").hide();
        $("#progression").hide();
        $("#numberofTests").hide();
        document.getElementById("fill").style.width="0%";
        NumberOfTests.innerText="";
        if(typeof kontrola==="undefined"){}else{
            kontrola.disconnect();
        }
        balicekKaretDobry.innerText="";
        balicekKaretSpatny.innerText="";
        balicekKaretVyber.innerText="";
        for(let i=0;i<NumberOfPossibleAnswers;i++){
            ABCDanswer[i].style.border="solid 3px rgb(189, 213, 234)";
        }
        substituteForInput.innerText="";
        BorderForTextInput.style.border="none";
        BorderForTextInputArtikel.style.border="none";
        nw.style.display="none";
        TextInput.value="";
        TextInputArtikel.value="";
        CanUseEsc=false;
        CanUseEnter=false;
        CanUseArrows=false;
        dvapokusy=1;
        document.getElementById("fill").style.width="0px";
        document.getElementById("vyber").onclick="";
        removeDrag([balicekKaretSpatny],[balicekKaretVyber]);
    };
    // příprava sady otázek
    function teststart(type,test,into,category){
        $(".Teorie").hide();
        TypeOfTest=type;
        Boost=5;
        Penalty=0;
        MomentalFillWidth=0;
        switch(type){
            case "ABCD":
                $("#numberofTests").show();
                $("#progression").show();
                $("."+type).show();
                Into=into;
                UnusedQuestions=NJG[category][test][1];
                Success=Array.from({length:Object.keys(UnusedQuestions).length},(_,i) => 1);
                NumberForCalculationOfSuccess=0;
                document.getElementById("ABCDodpovedi").innerText="";
                ABCD=["A","B","C","D"];
                ABCDanswer=document.getElementsByClassName("Felix");
                NumberOfPossibleAnswers=NJG[category][test][0];
                for(let i=0;i<NumberOfPossibleAnswers;i++){
                    document.getElementById("ABCDodpovedi").innerHTML+=`<div style='border:solid 3px rgb(189, 213, 234)' type='button' class='Felix' id='${ABCD[i]}' onclick='checkanswer(\"${ABCD[i]}\")'>Odpoved ${ABCD[i]}</div>`;
                };
                nt=Object.keys(UnusedQuestions).length;
                ant=0;
                ABCDhover();
                newquestion();
                break;
            case "TextInput":
                $("#numberofTests").show();
                $("#progression").show();
                $("."+type).show();
                Into=into;
                SetOfQuestions=NJG[category][test][1];
                UnusedQuestions=Object.keys(SetOfQuestions);
                Success=Array.from({length:Object.keys(SetOfQuestions).length},(_,i) => 1);
                NumberForCalculationOfSuccess=0;
                nt=Object.keys(SetOfQuestions).length;
                ant=0;
                newquestion();
                break;
            case "CZtoN":
            case "NtoCZ":
                $("#progression").show();
                $(".TextInput").show();
                nw.style.display="block";
                if(type=="CZtoN"){
                    document.getElementById("QuestionMark").style.display="flex";
                }
                UnusedQuestions=Array.from({length:CurrentVocabulary[0]}, (_, i) => i);
                Success=Array.from({length:CurrentVocabulary[0]},(_,i) => 1);
                NumberForCalculationOfSuccess=0
                newquestion();
                break;
            case "FlashCards":
                $(".FLASHCARDS").show();
                CanUseEnter=true;
                CanUseArrows=true;
                FlashcardsPreparing();
                break;
            case "Pexeso":
                $(".Pexeso").show();
                n=Array.from({length:10}, (_, i) => i);
                m=Array.from({length:10}, (_, i) => i);
                NumberForCalculationOfSuccess=0;
                Success=Array.from({length:10},(_,i) => 1);
                Completed=0;

                if(test=="W"){
                    keys=Array.from({length:CurrentVocabulary[0]}, (_, i) => i);
                    for(let i=0;i<10;i++){
                        a=Math.floor(Math.random()*keys.length);
                        k=Math.floor(Math.random()*n.length)
                        j=Math.floor(Math.random()*m.length)
                        document.getElementById("np"+[n[k]]).innerText=CurrentVocabulary[3][keys[a]]+" "+CurrentVocabulary[1][keys[a]];
                        document.getElementById("czp"+[m[j]]).innerText=CurrentVocabulary[2][keys[a]];
                        m.splice(j,1);
                        n.splice(k,1);
                        keys.splice(a,1);
                    }
                    for(let i=0;i<10;i++){
                        cz=document.getElementById("czp"+i);
                        n=document.getElementById("np"+i);
                        cz.style.animation="";
                        n.style.animation="";
                        cz.style.border="solid var(--brighterBlue) 3px";
                        n.style.border="solid var(--brighterBlue) 3px";
                    }
                    newquestion("W")
                }
                else{
                    SetOfQuestions=NJG[category][test][1];
                    keys=Object.keys(SetOfQuestions);
                    for(let i=0;i<10;i++){
                        a=Math.floor(Math.random()*keys.length)
                        k=Math.floor(Math.random()*n.length)
                        j=Math.floor(Math.random()*m.length)
                        document.getElementById("np"+[n[k]]).innerText=keys[a]
                        document.getElementById("czp"+[m[j]]).innerText=SetOfQuestions[keys[a]]
                        m.splice(j,1);
                        n.splice(k,1);
                        keys.splice(a,1)
                    }
                    for(let i=0;i<10;i++){
                        cz=document.getElementById("czp"+i);
                        n=document.getElementById("np"+i);
                        cz.style.animation="";
                        n.style.animation="";
                        cz.style.border="solid var(--brighterBlue) 3px";
                        n.style.border="solid var(--brighterBlue) 3px";
                    }
                    newquestion()
                }

                break
        }  
    };
    // zkontrolovává odpovědi, dál rozhoduje co se bude dít
    async function checkanswer(x){
        switch(TypeOfTest){
            case "ABCD":
                a=document.getElementById(x)
                if (UnusedQuestions[MomentalQuestion].a==a.innerText){
                    a.style.border="3px solid "+spravnabarva;
                    UnusedQuestions.splice(MomentalQuestion,1);
                    if(document.getElementById("chvilkanakontrolu").checked){
                        await sleep(500);
                    }
                    for (let i=0;i<NumberOfPossibleAnswers;i++){
                        ABCDanswer[i].style.border=zakladnibarva; 
                    }
                    MomentalFillWidth+=Boost;
                    if(MomentalFillWidth>100){
                        MomentalFillWidth=100;
                    }else if(MomentalFillWidth>=75){
                        Boost=2;
                        Penalty=4;
                    }else if (MomentalFillWidth>=50){
                        Boost=3;
                        Penalty=3;
                    }else if (MomentalFillWidth>=25){
                        Boost=4;
                        Penalty=2;
                    }
                    document.getElementById("fill").style.width=MomentalFillWidth+"%";
                    ant+=1;
                    newquestion();
                }
                else{
                    Success[MomentalQuestion]=0;
                    a.style.border="3px solid "+spatnabarva;
                }
                break;
            case "TextInput":
                // dodělat rozdělení mezi jednou a vícero možnými odpovědi.
                if (Into=="CZ" && SetOfQuestions[UnusedQuestions[MomentalQuestion]].split(", ").indexOf(TextInput.value)>-1){
                    BorderForTextInput.style.border="3px solid "+spravnabarva;
                    if(document.getElementById("chvilkanakontrolu").checked){
                        await sleep(500);
                    }
                    UnusedQuestions.splice(MomentalQuestion,1);
                    ant+=1;

                    BorderForTextInput.style.border="none";
                    TextInput.value="";
                    MomentalFillWidth+=Boost;
                    if(MomentalFillWidth>100){
                        MomentalFillWidth=100;
                    }else if(MomentalFillWidth>=75){
                        Boost=2;
                        Penalty=4;
                    }else if (MomentalFillWidth>=50){
                        Boost=3;
                        Penalty=3;
                    }else if (MomentalFillWidth>=25){
                        Boost=4;
                        Penalty=2;
                    }
                    document.getElementById("fill").style.width=MomentalFillWidth+"%";
                    
                    newquestion()
                }
                else if(Into=="N" && UnusedQuestions[MomentalQuestion].split(", ").indexOf(TextInput.value)>-1){
                    BorderForTextInput.style.border="3px solid "+spravnabarva;
                    if(document.getElementById("chvilkanakontrolu").checked){
                        await sleep(500);
                    }
                    UnusedQuestions.splice(MomentalQuestion,1);
                    ant+=1;
                    MomentalFillWidth+=Boost;
                    if(MomentalFillWidth>100){
                        MomentalFillWidth=100;
                    }else if(MomentalFillWidth>=75){
                        Boost=2;
                        Penalty=4;
                    }else if (MomentalFillWidth>=50){
                        Boost=3;
                        Penalty=3;
                    }else if (MomentalFillWidth>=25){
                        Boost=4;
                        Penalty=2;
                    }
                    document.getElementById("fill").style.width=MomentalFillWidth+"%";
                    BorderForTextInput.style.border="none";
                    TextInput.value="";
                    newquestion()
                }
                else{
                    BorderForTextInput.style.border="3px solid "+spatnabarva;
                    if(dvapokusy==0){
                        Success[MomentalQuestion]=0;
                        if(Into=="CZ"){
                            substituteForInput.innerText=SetOfQuestions[UnusedQuestions[MomentalQuestion]];
                        }else{
                            substituteForInput.innerText=UnusedQuestions[MomentalQuestion];
                        }
                    }
                    else if (dvapokusy==-1) {
                        MomentalFillWidth-=Penalty;
                        if(MomentalFillWidth<0){
                            MomentalFillWidth=0;
                        }else if(MomentalFillWidth<25){
                            Boost=5;
                            Penalty=0;
                        }else if (MomentalFillWidth<50){
                            Boost=4;
                            Penalty=2;
                        }else if (MomentalFillWidth<75){
                            Boost=3;
                            Penalty=3;
                        }
                        document.getElementById("fill").style.width=MomentalFillWidth+"%";
                        substituteForInput.innerText="";
                        BorderForTextInput.style.border="none";
                        TextInput.value="";
                        newquestion();
                    }
                    dvapokusy--;
                }
                break;
            case "NtoCZ":
            case "CZtoN":
                let n;
                let slovicka;
                let itcanbe=false;
                if(TypeOfTest=="NtoCZ"){
                    slovicka=CurrentVocabulary[2][UnusedQuestions[MomentalQuestion]].split(", ");
                    for(let i=0;i<slovicka.length;i++){
                        if (slovicka[i]==TextInput.value && !slovicka[i].includes("-")){
                            itcanbe=true;
                            break;
                        }
                    }
                    if(itcanbe){
                        
                        MomentalFillWidth+=Boost;
                        if(MomentalFillWidth>100){
                            MomentalFillWidth=100;
                        }else if(MomentalFillWidth>=75){
                            Boost=2;
                            Penalty=4;
                        }else if (MomentalFillWidth>=50){
                            Boost=3;
                            Penalty=3;
                        }else if (MomentalFillWidth>=25){
                            Boost=4;
                            Penalty=2;
                        }
                        document.getElementById("fill").style.width=MomentalFillWidth+"%";

                        UnusedQuestions.splice(MomentalQuestion,1);
                        BorderForTextInput.style.border="3px solid "+spravnabarva;
                        if(document.getElementById("chvilkanakontrolu").checked){
                            await sleep(500);
                        }
                        BorderForTextInput.style.border="none";
                        TextInput.value="";
                        newquestion();
                    }
                    else{

                        BorderForTextInput.style.border="3px solid "+spatnabarva;
                        if(dvapokusy==0){
                            Success[MomentalQuestion]=0;
                            substituteForInput.innerText=CurrentVocabulary[2][UnusedQuestions[MomentalQuestion]];
                            
                        }else if(dvapokusy==-1){
                            MomentalFillWidth-=Penalty;
                            if(MomentalFillWidth<0){
                                MomentalFillWidth=0;
                            }else if(MomentalFillWidth<25){
                                Boost=5;
                                Penalty=0;
                            }else if (MomentalFillWidth<50){
                                Boost=4;
                                Penalty=2;
                            }else if (MomentalFillWidth<75){
                                Boost=3;
                                Penalty=3;
                            }
                            document.getElementById("fill").style.width=MomentalFillWidth+"%";
                            substituteForInput.innerText="";
                            UnusedQuestions.splice(MomentalQuestion,1);
                            BorderForTextInput.style.border="none";
                            TextInput.value="";
                            newquestion();
                        }
                        dvapokusy--;
                    }
                }
                else{
                    slovicka=CurrentVocabulary[1][UnusedQuestions[MomentalQuestion]].split(", ");
                    derdiedas=false;
                    for(let i=0;i<slovicka.length;i++){
                        if(!CurrentVocabulary[3][UnusedQuestions[MomentalQuestion]]){
                            if(slovicka[i]==TextInput.value && !slovicka[i].includes("-")){
                                itcanbe=true;
                                derdiedas=true;
                                break;
                            }
                        }
                        else{
                            if(CurrentVocabulary[3][UnusedQuestions[MomentalQuestion]]==TextInputArtikel.value){
                                derdiedas=true;
                            }
                            if(slovicka[i]==TextInput.value && !slovicka[i].includes("-")){
                                itcanbe=true;
                                break;
                            }
                        }
                    }
                    if(itcanbe && derdiedas){
                        MomentalFillWidth+=Boost;
                        if(MomentalFillWidth>100){
                            MomentalFillWidth=100;
                        }else if(MomentalFillWidth>=75){
                            Boost=2;
                            Penalty=4;
                        }else if (MomentalFillWidth>=50){
                            Boost=3;
                            Penalty=3;
                        }else if (MomentalFillWidth>=25){
                            Boost=4;
                            Penalty=2;
                        }
                        document.getElementById("fill").style.width=MomentalFillWidth+"%";
                        UnusedQuestions.splice(MomentalQuestion,1);
                        BorderForTextInputArtikel.style.border="3px solid "+spravnabarva;
                        BorderForTextInput.style.border="3px solid "+spravnabarva;
                        if(document.getElementById("chvilkanakontrolu").checked){
                            await sleep(500);
                        }
                        BorderForTextInput.style.border="none";
                        BorderForTextInputArtikel.style.border="none";
                        TextInput.value="";
                        TextInputArtikel.value="";
                        newquestion();
                    }
                    else{
                        if(!derdiedas){
                            BorderForTextInputArtikel.style.border="3px solid "+spatnabarva;
                        }
                        if(!itcanbe){
                            BorderForTextInput.style.border="3px solid "+spatnabarva;
                        }
                        if(dvapokusy==0){
                            Success[MomentalQuestion]=0;
                            substituteForInput.innerText=CurrentVocabulary[3][UnusedQuestions[MomentalQuestion]]+" "+CurrentVocabulary[1][UnusedQuestions[MomentalQuestion]];
                        }else if(dvapokusy==-1){
                            MomentalFillWidth-=Penalty;
                            if(MomentalFillWidth<0){
                                MomentalFillWidth=0;
                            }else if(MomentalFillWidth<25){
                                Boost=5;
                                Penalty=0;
                            }else if (MomentalFillWidth<50){
                                Boost=4;
                                Penalty=2;
                            }else if (MomentalFillWidth<75){
                                Boost=3;
                                Penalty=3;
                            }
                            document.getElementById("fill").style.width=MomentalFillWidth+"%";
                            substituteForInput.innerText="";
                            UnusedQuestions.splice(MomentalQuestion,1);
                            BorderForTextInput.style.border="none";
                            BorderForTextInputArtikel.style.border="none";
                            TextInput.value="";
                            TextInputArtikel.value="";
                            newquestion();
                        }
                        dvapokusy--;
                    }
                    }                
                break;
        }
    };
    // odesílá novou otázku https://www.youtube.com/watch?v=OnkTUKtxRiczku
    function newquestion(a){
        if (TypeOfTest=="Pexeso"){
            if(a=="W"){
                for(let i=0;i<10;i++){
                    document.getElementById("np"+i).onclick= async function(){
                        p=document.getElementById(CZchoosed)
                        if(p){
                            if(CurrentVocabulary[1][CurrentVocabulary[2].indexOf(p.innerText)]==this.innerText.substr(4)){
                                Completed+=1;
                                if(Completed==10){
                                    endoftest();
                                }
                                else{
                                    Nchoosed=null;
                                    CZchoosed=null;
                                    this.style.animation="fromRedToBlue 1s forwards";
                                    p.style.animation="fromRedToBlue 1s forwards";
                                }
                            }
                            else{
                                this.style.animation="shake 0.82s cubic-bezier(.36,.07,.19,.97) both";
                                await sleep(820);
                                this.style.animation="";
                                Success[i]=0;
                            }
                        }
                        else{
                            if (this.style.border=="solid var(--red) 3px"){
                                this.style.border="solid var(--brighterBlue) 3px";
                                Nchoosed=null;
                            }else{
                                for(let y=0;y<10;y++){
                                    document.getElementById("np"+y).style.border="solid var(--brighterBlue) 3px";
                                }
                                this.style.border="solid var(--red) 3px";
                                Nchoosed=this.id;
                            }
                        }
                    }
                    document.getElementById("czp"+i).onclick= async function(){
                        p=document.getElementById(Nchoosed)
                        if(p){
                            if(CurrentVocabulary[1][CurrentVocabulary[2].indexOf(this.innerText)]==p.innerText.substr(4)){
                                Completed+=1;
                                if(Completed==10){
                                    endoftest();
                                }
                                else{
                                    CZchoosed=null;
                                    Nchoosed=null;
                                    this.style.animation="fromRedToBlue 1s forwards";
                                    p.style.animation="fromRedToBlue 1s forwards";
                                }
                            }else{
                                this.style.animation="shake 0.82s cubic-bezier(.36,.07,.19,.97) both";
                                await sleep(820);
                                this.style.animation="";
                                Success[i]=0;
                            }
                        }
                        else{
                            if (this.style.border=="solid var(--red) 3px"){
                                this.style.border="solid var(--brighterBlue) 3px";
                                CZchoosed=null;
                            }else{
                                for(let y=0;y<10;y++){
                                    document.getElementById("czp"+y).style.border="solid var(--brighterBlue) 3px";
                                }
                                this.style.border="solid var(--red) 3px";
                                CZchoosed=this.id;
                            }
                        }
                    }
                }
            }
            else{
                for(let i=0;i<10;i++){
                    document.getElementById("np"+i).onclick= async function(){
                        p=document.getElementById(CZchoosed)
                        if(p){
                            if(SetOfQuestions[this.innerText]==p.innerText){
                                Completed+=1;
                                if(Completed==10){
                                    endoftest();
                                }
                                else{
                                    Nchoosed=null;
                                    CZchoosed=null;
                                    this.style.animation="fromRedToBlue 1s forwards";
                                    p.style.animation="fromRedToBlue 1s forwards";
                                }
                            }else{
                                this.style.animation="shake 0.82s cubic-bezier(.36,.07,.19,.97) both";
                                await sleep(820);
                                this.style.animation="";
                                Success[i]=0;
                            }
                        }else{
                            if (this.style.border=="solid var(--red) 3px"){
                                this.style.border="solid var(--brighterBlue) 3px";
                                Nchoosed=null;
                            }else{
                                for(let y=0;y<10;y++){
                                    document.getElementById("np"+y).style.border="solid var(--brighterBlue) 3px";
                                }
                                this.style.border="solid var(--red) 3px";
                                Nchoosed=this.id;
                            }
                        }
    
                    }
                    document.getElementById("czp"+i).onclick=async function(){
                        p=document.getElementById(Nchoosed)
                        if(p){
                            if(SetOfQuestions[p.innerText]==this.innerText){
                                Completed+=1;
                                if(Completed==10){
                                    endoftest();
                                }
                                else{
                                    Nchoosed=null;
                                    CZchoosed=null;
                                    this.style.animation="fromRedToBlue 1s forwards";
                                    p.style.animation="fromRedToBlue 1s forwards";
                                }
                            }else{
                                this.style.animation="shake 0.82s cubic-bezier(.36,.07,.19,.97) both";
                                await sleep(820);
                                this.style.animation="";
                                Success[i]=0;
                            }
                        }
                        else{
                            if (this.style.border=="solid var(--red) 3px"){
                                this.style.border="solid var(--brighterBlue) 3px";
                                CZchoosed=null;
                            }else{
                                for(let y=0;y<10;y++){
                                    document.getElementById("czp"+y).style.border="solid var(--brighterBlue) 3px";
                                }
                                this.style.border="solid var(--red) 3px";
                                CZchoosed=this.id;
                            }
                        }
                    }
                }
            }
        }
        else if (UnusedQuestions.length>0){
            switch(TypeOfTest){
                case "ABCD":
                case "TextInput":
                    a=Math.floor(Math.random()*UnusedQuestions.length);   
                    break;
                case "CZtoN":
                case "NtoCZ":
                    a=Math.floor(Math.random()*UnusedQuestions.length);
                    break;   
            }
            MomentalQuestion=a;
            dvapokusy=1;
            switch(TypeOfTest){
                case "ABCD":
                    document.getElementById("FrantaABCD").innerText=UnusedQuestions[a]["q"];
                    b=["a","1","2","3"];
                    for (let i=0;i<NumberOfPossibleAnswers;i++){
                        d=Math.floor(Math.random()*Math.abs(NumberOfPossibleAnswers-i));
                        ABCDanswer[i].innerText=UnusedQuestions[a][b[d]];
                        b.splice(d,1);
                    };
                    NumberOfTests.innerText=ant+"/"+Success.length;
                    break;
                case "TextInput":
                    NumberOfTests.innerText=ant+"/"+Success.length;
                    CanUseEnter=true;
                    if(NumberOfPossibleAnswers==1){
                        // pokud to mám uložené jako dictionary {"N":"CZ"}
                        if(Into=="CZ"){
                            document.getElementById("FrantaX").innerText=UnusedQuestions[MomentalQuestion];
                        }else{
                            document.getElementById("FrantaX").innerText=SetOfQuestions[UnusedQuestions[MomentalQuestion]];
                        }
                    }
                    else{
                        // pokud bývá více odpovědí v ABCD možnostech                        
                        document.getElementById("FrantaX").innerText=UnusedQuestions[a];
                    }
                    window.setTimeout(() => TextInput.focus(), 0);
                    break;
                case "CZtoN":
                    nw.innerText=CurrentVocabulary[0]-UnusedQuestions.length+"/"+CurrentVocabulary[0];
                    CanUseEnter=true;
                    if(CurrentVocabulary[3][UnusedQuestions[MomentalQuestion]]){
                        BorderForTextInputArtikel.style.display="block";
                        window.setTimeout(() => TextInputArtikel.focus(), 0);
                    }else{
                        BorderForTextInputArtikel.style.display="none";
                        window.setTimeout(() => TextInput.focus(), 0);
                    }
                    document.getElementById("FrantaX").innerText=CurrentVocabulary[2][UnusedQuestions[MomentalQuestion]];
                    break;
                case "NtoCZ":
                    
                window.setTimeout(() => TextInput.focus(), 0);
                    CanUseEnter=true;
                    document.getElementById("FrantaX").innerText=CurrentVocabulary[3][UnusedQuestions[MomentalQuestion]]+" "+CurrentVocabulary[1][UnusedQuestions[MomentalQuestion]];
                    break;
            };
        }
        else{
            endoftest();
        };
    };
    // ukončení testu, gratulace
    function endoftest(){
        $(".task").hide();
        $("#progression").hide();
        $("#numberofTests").hide();

        for (let i=0;i<Success.length;i++){
            NumberForCalculationOfSuccess+=Success[i];
        };
        x=Math.round(NumberForCalculationOfSuccess/Success.length*100);
        document.getElementById("procenta").innerText=x+"%";
        $(".congratulation").show();
        $.post("/Germany", {
            submit_button:"ENDOFTEST",
            nameOfTest: nameOfTest,
            value:x,
        });
        CanUseArrows=false;
        CanUseEnter=false;
        NumberOfTests.innerText="";
    }
    
    // hlídá, jestli má zobrazit výsledek pro TextInput nebo ne 
    let SubstituteForInputKontrol = new MutationObserver(function(){
        if (substituteForInput.innerText!=""){
            BorderForTextInput.style.display="none";
            BorderForTextInputArtikel.style.display="none";
            substituteForInput.style.display="block";
        }
        else{
            substituteForInput.style.display="none";
            BorderForTextInput.style.display="block";
        };
    });
    SubstituteForInputKontrol.observe(substituteForInput,config);
    // na zmáčknutí určitých kláves
    document.addEventListener("keydown",function(e){
        if(e.key==="Enter" && CanUseEnter){
            switch (TypeOfTest){
            case "FlashCards":
                rotatecard(balicekKaretVyber.children[balicekKaretVyber.children.length-1]);
                break;
            case "CZtoN":
            case "NtoCZ":
            case "TextInput":
                if (dvapokusy==-1){
                    substituteForInput.innerText="";
                    BorderForTextInput.style.border="none";
                    BorderForTextInputArtikel.style.border="none";
                    TextInput.value="";
                    TextInputArtikel.value="";
                    MomentalFillWidth-=Penalty;
                    if(MomentalFillWidth<0){
                        MomentalFillWidth=0;
                    }else if(MomentalFillWidth<25){
                        Boost=2.5;
                        Penalty=0;
                    }else if (MomentalFillWidth<50){
                        Boost=2;
                        Penalty=1;
                    }else if (MomentalFillWidth<75){
                        Boost=1.5;
                        Penalty=1.5;
                    }
                    document.getElementById("fill").style.width=MomentalFillWidth+"%";
                    newquestion();
                }else if (dvapokusy==1 || dvapokusy==0){
                    checkanswer("TextInput");
                }
            }
        }
        else if (e.key==="Escape" && CanUseEsc){
            if(PreparedTest){
                exitPDF();
            }else{
                hider();
            }
        }
        else if (e.key==="ArrowLeft" && CanUseArrows){
            if(balicekKaretVyber.firstChild){
                balicekKaretSpatny.appendChild(balicekKaretVyber.children[balicekKaretVyber.children.length-1]);
            }
        }
        else if (e.key==="ArrowRight" && CanUseArrows){
            if(balicekKaretVyber.firstChild){
                balicekKaretDobry.appendChild(balicekKaretVyber.children[balicekKaretVyber.children.length-1]);
            }
        };
    })
</script>
<!-- Všechno pro tvorbu PDF testům -->
<script>
// užitečné odkazy:
// Basic examples: https://mrrio.github.io/jsPDF/examples/basic.html
// for fonts: https://www.devlinpeck.com/tutorials/jspdf-custom-font

for(let x=1;x<Object.keys(NJW).length+1;x++){
    z=Object.keys(NJW["module"+x]);
    for(let y=0;y<z.length;y++){
        document.getElementById("LW").innerHTML+=`<tr><td>${x}</td><td>${z[y]}</td></tr>`;
    }
}
h=Object.keys(NJG);
for(let x=0;x<Object.keys(NJG).length;x++){
    z=Object.keys(NJG[h[x]]);
    for(let y=0;y<z.length;y++){
        if(z[y][0]!=1){
            document.getElementById("LG").innerHTML+=`<tr><td>${h[x]}</td><td>${z[y]}</td></tr>`;
        }
    }
}
const MChoose =document.getElementById("ModuleChoose");
const SlDChoose =document.getElementById("SlDChoose");
const canvas = document.getElementById("canvas");
const PageNumber =document.getElementById("PageNumber");
const RightButton =document.getElementById("RightButton");
const LeftButton =document.getElementById("LeftButton");
const ButtonAddTask = document.getElementById("newTask");
const TasksG= document.getElementById("LG").getElementsByTagName("tr");
const TasksW = document.getElementById("LW").getElementsByTagName("tr");
const TableQuestionsG = Array.from(TasksG);
const TableQuestionsW = Array.from(TasksW);
const NavrhPlatno = document.getElementsByClassName("Platno");
const GramButton = document.getElementById("Grammatikk");
const WortButton = document.getElementById("Wortschatzz");
let CurrentPTest;
let Ukolu=0;
let CurrentPage = 1;
let markTask;
let hlidacGW="G";
let PreparedTest=false;
WortButton.onclick=function(){
    GramButton.style.backgroundColor="transparent";
    GramButton.style.color="black";
    WortButton.style.backgroundColor="rgb(55, 55, 55)"
    WortButton.style.color="white";
    document.getElementById("LGT").style.display="none";
    document.getElementById("LWT").style.display="block";
    document.getElementById("FG").style.display="none";
    document.getElementById("FW").style.display="block";
    markTask="";
    for(let x=0;x<TasksG.length;x++){   
        TasksG[x].style.backgroundColor="inherit";
    }
    hlidacGW="W";
}
GramButton.onclick=function(){
    WortButton.style.backgroundColor="transparent";
    WortButton.style.color="black";
    GramButton.style.backgroundColor="rgb(55, 55, 55)"
    GramButton.style.color="white";
    document.getElementById("LWT").style.display="none";
    document.getElementById("LGT").style.display="block";
    document.getElementById("FG").style.display="block";
    document.getElementById("FW").style.display="none";
    markTask="";
    for(let x=0;x<TasksW.length;x++){   
        TasksW[x].style.backgroundColor="inherit";
    }
    hlidacGW="G";

}
for(let i=0;i<TasksG.length;i++){
    let tr = TasksG[i]
    tr.onclick=function(){
        if (tr.style.backgroundColor!="var(--brighterBlue)")
        {
            for(let x=0;x<TasksG.length;x++){   
                TasksG[x].style.backgroundColor="inherit";
            }
            tr.style.backgroundColor="var(--brighterBlue)";
            markTask=tr;
            ButtonAddTask.classList.add("newTaskH");
            ButtonAddTask.style.opacity="1";
        }
        else{
            markTask="";
            ButtonAddTask.classList.remove("newTaskH");
            ButtonAddTask.style.opacity="0.5";
            tr.style.backgroundColor="inherit";
        }
    }
}
for(let i=0;i<TasksW.length;i++){
    let tr = TasksW[i]
    tr.onclick=function(){
        if (tr.style.backgroundColor!="var(--brighterBlue)")
        {
            for(let x=0;x<TasksW.length;x++){   
                TasksW[x].style.backgroundColor="inherit";
            }
            tr.style.backgroundColor="var(--brighterBlue)";
            markTask=tr;
            ButtonAddTask.classList.add("newTaskH");
            ButtonAddTask.style.opacity="1";
        }
        else{
            markTask="";
            ButtonAddTask.classList.remove("newTaskH");
            ButtonAddTask.style.opacity="0.5";
            tr.style.backgroundColor="inherit";
        }
    }
}
function addTask (){
    let Page=canvas.getElementsByClassName("list")[CurrentPage-1].getElementsByClassName("content")[0]
    let h=0;
    for(let i=0;i<Page.children.length;i++){h+=Page.children[i].offsetHeight;}
    if(markTask!=""){
        if(hlidacGW=="G"){
            if(h+68<Page.offsetHeight){
                let TaskDiv = `
                <div class='TaskDiv' style="height:68px">
                    <b><div class="TaskName" datavalue=""></div></b>
                    (<span class="sld"></span>)
                    Otázek: <select class='numberOfQuestions' datavalue="" onfocus="this.setAttribute('datavalue', this.value)">
                        <option value='6'>6</option>
                        <option value='8'>8</option>
                        <option value='10'>10</option>
                        <option value='12'>12</option>
                        <option value='14'>14</option>
                        <option value='16'>16</option>
                        <option value='18'>18</option>
                        <option value='20'>20</option>
                    </select>
                    <div class="taskRemove" onclick="this.parentElement.remove()">✕</div>
                </div>`;
                Page.insertAdjacentHTML("beforeend",TaskDiv);
                Page.lastChild.getElementsByClassName("sld")[0].innerText=markTask.children[0].innerText;
                Page.lastChild.getElementsByClassName("TaskName")[0].innerText=markTask.children[1].innerText;
                Page.lastChild.getElementsByClassName("TaskName")[0].datavalue="G";
                Page.lastChild.getElementsByTagName("select")[0].addEventListener("change",function(){
                    h=0;
                    for(let i=0;i<Page.children.length;i++){h+=Page.children[i]!=this.parentElement?Page.children[i].offsetHeight:0;}
                    if(h+8*this.value+20<Page.offsetHeight){
                        this.parentElement.style.height=8*this.value+20+"px";
                    }
                    else{
                        this.value=this.getAttribute("datavalue");
                    }
                    this.blur();
                });
            }
        }
        else{
            if(h+49.6<Page.offsetHeight){
            let TaskDiv = `
            <div class='TaskDiv' style="height:49.6px">
                <b><div class="TaskName" datavalue=""></div></b>
                (<span class="m"></span>)
                Slovíček: <select class='numberOfQuestions' datavalue="" onfocus="this.setAttribute('datavalue', this.value)">
                    <option value='8'>8</option>
                    <option value='12'>12</option>
                    <option value='16'>16</option>
                    <option value='20'>20</option>
                </select> 
                <span>Překlad:</span>
                <select class="TypeOfTranslation">
                    <option value='N>CZ'>N>CZ</option>
                    <option value='CZ>N'>CZ>N</option>
                    <option value='50%'>50%</option>
                </select>
                <div class="taskRemove" onclick="this.parentElement.remove()">✕</div>
            <div>`;
            Page.insertAdjacentHTML("beforeend",TaskDiv);
            Page.lastChild.getElementsByClassName("m")[0].innerText=markTask.children[0].innerText;
            Page.lastChild.getElementsByClassName("TaskName")[0].innerText=markTask.children[1].innerText;
            Page.lastChild.getElementsByClassName("TaskName")[0].datavalue="W";
            Page.lastChild.getElementsByTagName("select")[0].addEventListener("change",function(e){
                h=0;
                for(let i=0;i<Page.children.length;i++){h+=Page.children[i]!=this.parentElement?Page.children[i].offsetHeight:0;}
                if(h+3.8*this.value+20<Page.offsetHeight){
                    this.parentElement.style.height=3.8*this.value+20+"px";
                }
                else{
                    this.value=this.getAttribute("datavalue");
                }
                this.blur();
            });

            } 
        }
    }
}
async function downloadPDF(){
    if (/^[A-Za-z0-9|ě|š|č|ř|ž|ý|á|í|é|ů|ú|ß|ó|Ó|Ě|Š|Č|Ř|Ž|Ý|Á|Í|É|Ů|Ú|ü|ë|ä|ö|ÿ|Ü|Ë|Ä|Ö|Ÿ|\s]+$/g.test(document.getElementById("TN").innerText)){
        let pages=document.getElementsByClassName("Platno");
        const doc = new jsPDF('p','mm','a4');
        // for (let i=0;i<1;i++){
        //     await doc.html(NavrhPlatno[i])
        // }
        doc.setFont("Calibri Bold","bold");
        doc.setFontSize(20);
        doc.text(document.getElementById("TN").innerText,10,10);
        doc.setFont("Calibri Regular","normal");
        doc.setFontSize(16);
        doc.text(document.getElementById("SN").innerText,10,20);
        doc.text(document.getElementById("DN").innerText,150,10);
        doc.text(document.getElementById("CN").innerText,154,20);
        doc.line(10,30,200,30);
        let ukol=1;
        let i=0;
        do{
            page=pages[i];
            if(i!=0){
                doc.addPage();
            }
            let h=0;
            for(let x=0;x<page.getElementsByClassName("ukol").length;x++){
                Task=page.getElementsByClassName("ukol")[x];
                doc.setFontSize(16);
                doc.setFont("Calibri Bold","bold");
                if(Task.classList.contains("gram")){
                    doc.text(Task.getElementsByClassName("zadani")[0].innerText,10,i!=0?(h+15):(40+h));
                    h+=5;
                    doc.setFontSize(12);
                    doc.setFont("Calibri Regular","normal");
                    ptag=Task.getElementsByClassName("TContent")[0].children;
                    for(let y=0;y<ptag.length;y++){
                        doc.text(`${ptag[y].innerText}`,10,i!=0?(h+15):(40+h));
                        h+=6;
                    }
                }
                else{
                    doc.text(Task.getElementsByClassName("zadani")[0].innerText,10,i!=0?h+15:40+h);
                    h+=5;
                    doc.setFontSize(12);
                    doc.setFont("Calibri Regular","normal");
                    slovicka=Task.getElementsByClassName("container")[0].children;
                    for(let y=0;y<slovicka[0].children.length;y++){
                        for(let z=0;z<2;z++){
                            doc.text(`${slovicka[z].getElementsByTagName("p")[y].innerText}`,10+z*90,i!=0?15+h:40+h);
                        }
                    h+=6;
                }
            }
            ukol++;
            h+=5;
        }
            i++;
            doc.text(i.toString(),100,290);
        }while(i<pages.length)
        doc.save(document.getElementById("TN").innerText+".pdf");
    }
    else{
        console.log("chyba")
    }
}
function savePDF(){
    if (document.getElementById("TN").innerText.match("^[A-Za-z0-9]+$")){
        TestToSend="";
        let i=0;
        let pages=document.getElementsByClassName("Platno");
        do{
            page=pages[i];
            
            for(let x=0;x<page.getElementsByClassName("ukol").length;x++){
                Task=page.getElementsByClassName("ukol")[x];
                if(Task.classList.contains("gram")){
                    ptag=Task.getElementsByClassName("TContent")[0].children;
                    TestToSend+=`;${Task.getElementsByClassName("zadani")[0].innerText}`;
                    for(let y=0;y<ptag.length;y++){
                        TestToSend+=`$${ptag[y].innerText}:${ptag[y].getAttribute("value")}`;
                    }
                }
                else{
                    TestToSend+=`;${Task.getElementsByClassName("zadani")[0].innerText}`;
                    slovicka=Task.getElementsByClassName("container")[0].children;
                    for(let y=0;y<slovicka[0].children.length;y++){
                        for(let z=0;z<2;z++){
                            TestToSend+=`$${slovicka[z].getElementsByTagName("p")[y].innerText}:${slovicka[z].getElementsByTagName("p")[y].getAttribute("value")}`;
                        }
                    }
                }
        }
            i++;
        }while(i<pages.length)
    
        $.post("/Germany", {
            submit_button:"SAVETEST",
            name:document.getElementById("TN").innerText,
            value:TestToSend.substring(1)
        });
        console.log("úspěch");
    }
}
function showTest(){
    PreparedTest=true;
    document.getElementById("clickDisabler2").style.display="block";
    randomPDF();
}
function randomPDF(){
    document.getElementById("Former").innerHTML=`
    <div class="Platno">
        <div id="ZP">
            <b><div id="TN" contenteditable="true" spellcheck="false">Test</div></b>
            <div id="SN" contenteditable="true" spellcheck="false">jméno: </div>
            <div id="CN" contenteditable="true" spellcheck="false">třída: </div>
            <div id="DN" contenteditable="true" spellcheck="false">datum: </div>
            <hr style="position:absolute;top:100px;width:calc(100% - 50px);">
        </div>
    </div>`;
    let pages=document.getElementsByClassName("list");
    document.getElementById("TN").innerText=document.getElementById("nameOfTest").innerText;
    document.getElementById("SN").innerText=document.getElementById("studentName").innerText;
    document.getElementById("CN").innerText=document.getElementById("className").innerText;
    document.getElementById("DN").innerText=document.getElementById("datumName").innerText;
    let ukol=1;
    let i=0;
    do{
        page=pages[i];
        if(i!=0){
            document.getElementById("Former").innerHTML+="<div class='Platno'></div>"
        }
        for(let x=0;x<page.getElementsByClassName("content")[0].children.length;x++){
            Task=page.getElementsByClassName("content")[0].children[x];
            if(Task.getElementsByClassName("TaskName")[0].datavalue=="G"){
                TaskQ =NJG[Task.getElementsByClassName("sld")[0].innerText][Task.getElementsByClassName("TaskName")[0].innerText];
                TaskToPlace=`
                <div class="ukol gram" onclick="randomUkol(this)">
                    <div class="zadani"value="${Task.getElementsByClassName("sld")[0].innerText}/${Task.getElementsByClassName("TaskName")[0].innerText}/${ukol}/${Task.getElementsByClassName("numberOfQuestions")[0].value}">
                        <b>${ukol}. ${TaskQ[2]}</b>
                    </div>
                <div class="TContent">`;
                UnusedQuestions=Array.from({length:TaskQ[1].length}, (_, i) => i);
                for(let y=0;y<Task.getElementsByClassName("numberOfQuestions")[0].value;y++){
                    randomNumber=Math.floor(Math.random()*UnusedQuestions.length);
                    TaskToPlace+=`<p value="${TaskQ[1][UnusedQuestions[randomNumber]]["a"]}">${y+1}) ${TaskQ[1][UnusedQuestions[randomNumber]]["q"]}</p>`;
                    UnusedQuestions.splice(randomNumber,1);
                }
                TaskToPlace+="</div>"
                NavrhPlatno[i].innerHTML+=TaskToPlace
            }
            else{
                TaskQ =Object.values(NJW["module"+Task.getElementsByClassName("m")[0].innerText][Task.getElementsByClassName("TaskName")[0].innerText]);
                TaskToPlace=`
                <div class="ukol wort" onclick="randomUkol(this)">
                    <div class="zadani" value="${"module"+Task.getElementsByClassName("m")[0].innerText}/${Task.getElementsByClassName("TaskName")[0].innerText}/${Task.getElementsByClassName("TypeOfTranslation")[0].value}/${ukol}/${Task.getElementsByClassName("numberOfQuestions")[0].value/2}">
                        <b>${ukol}. Übersetzen diese Wörter</b>
                    </div>
                    <div class="container">`;
                UnusedQuestions=Array.from({length:TaskQ[0]}, (_, i) => i);

                for(let z=0;z<2;z++){
                    TaskToPlace+="<div class='pul'>";
                    for(let y=0;y<Task.getElementsByClassName("numberOfQuestions")[0].value/2;y++){
                        if(Task.getElementsByClassName("TypeOfTranslation")[0].value=="CZ>N"){
                            TOT=2;
                        }else if (Task.getElementsByClassName("TypeOfTranslation")[0].value=="N>CZ"){
                            TOT=1;
                        }else{
                            TOT=z+1;
                        }
                        randomNumber1=Math.floor(Math.random()*UnusedQuestions.length);
                        if(TaskQ[3][UnusedQuestions[randomNumber1]] && TOT==1){
                            TaskToPlace+=`<p value="${TaskQ[TOT==1?2:1][UnusedQuestions[randomNumber1]]}">${TaskQ[3][UnusedQuestions[randomNumber1]]+" "+TaskQ[TOT][UnusedQuestions[randomNumber1]]} </p>`;
                        }else{
                            TaskToPlace+=`<p value="${TaskQ[TOT==1?2:1][UnusedQuestions[randomNumber1]]}">${TaskQ[TOT][UnusedQuestions[randomNumber1]]} </p>`;
                        }
                        UnusedQuestions.splice(randomNumber1,1);
                    }
                    TaskToPlace+="</div>";
                }
                TaskToPlace+="</div></div>";
                NavrhPlatno[i].innerHTML+=TaskToPlace;
            }
            ukol++;
        }
        NavrhPlatno[i].innerHTML+=`<div class="PageNumber">${i+1}</div>`;
        i++;
    }while(i<pages.length)
}
function exitPDF (){
    PreparedTest=false;
    document.getElementById("clickDisabler2").style.display="none";
}
function randomUkol (ukol){
    if(ukol.classList.contains("gram")){
        a=ukol.getElementsByClassName("zadani")[0].getAttribute("value").split("/");
        TaskQ =NJG[a[0]][a[1]];
        TaskToPlace=`<div class="zadani" value="${ukol.getElementsByClassName("zadani")[0].getAttribute("value")}"><b>${a[2]}. ${TaskQ[2]}</b></div><div class="TContent">`;
        UnusedQuestions=Array.from({length:TaskQ[1].length}, (_, i) => i);
        for(let y=0;y<a[3];y++){
            randomNumber=Math.floor(Math.random()*UnusedQuestions.length);
            TaskToPlace+=`<p value="${TaskQ[1][UnusedQuestions[randomNumber]]["a"]}">${y+1}) ${TaskQ[1][UnusedQuestions[randomNumber]]["q"]}</p>`;
            UnusedQuestions.splice(randomNumber,1);
        }
        TaskToPlace+="</div>"
    }
    else{
        a=ukol.getElementsByClassName("zadani")[0].getAttribute("value").split("/");
        TaskQ =Object.values(NJW[a[0]][a[1]]);
        TaskToPlace=`<div class="zadani" value="${ukol.getElementsByClassName("zadani")[0].getAttribute("value")}"><b>${a[3]}. Übersetzen diese Wörter</b></div><div class="container">`;
        UnusedQuestions=Array.from({length:TaskQ[0]}, (_, i) => i);

        for(let z=0;z<2;z++){
            TaskToPlace+="<div class='pul'>";
            for(let y=0;y<a[4];y++){
                if(a[2]=="CZ>N"){
                    TOT=2;
                }else if (a[2]=="N>CZ"){
                    TOT=1;
                }else{
                    TOT=z+1;
                }
                randomNumber1=Math.floor(Math.random()*UnusedQuestions.length);
                if(TaskQ[3][UnusedQuestions[randomNumber1]] && TOT==1){
                    TaskToPlace+=`<p value="${TaskQ[TOT==1?2:1][UnusedQuestions[randomNumber1]]}">${TaskQ[3][UnusedQuestions[randomNumber1]]+" "+TaskQ[TOT][UnusedQuestions[randomNumber1]]} </p>`;
                }else{
                    TaskToPlace+=`<p value="${TaskQ[TOT==1?2:1][UnusedQuestions[randomNumber1]]}">${TaskQ[TOT][UnusedQuestions[randomNumber1]]} </p>`;
                }
                UnusedQuestions.splice(randomNumber1,1);
            }
            TaskToPlace+="</div>";
        }
        TaskToPlace+="</div></div>"
    }
    ukol.innerHTML=TaskToPlace
}
function sortTableByColumn(table, column, asc = true) {
    const dirModifier = asc ? 1 : -1;
    const tBody = table.tBodies[0];
    const rows = Array.from(tBody.querySelectorAll("tr"));
    // Sort each row
    const sortedRows = rows.sort((a, b) => {
        const aColText = a.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();
        const bColText = b.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();
        return aColText > bColText ? (1 * dirModifier) : (-1 * dirModifier);
    });

    // Remove all existing TRs from the table
    while (tBody.firstChild) {
        tBody.removeChild(tBody.firstChild);
    }

    // Re-add the newly sorted rows
    tBody.append(...sortedRows);
    // Remember how the column is currently sorted
    table.querySelectorAll("th").forEach(th => th.classList.remove("th-sort-asc", "th-sort-desc"));
    table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-asc", asc);
    table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-desc", !asc);
}
let tabulka1 = document.getElementById("LGT").getElementsByTagName("th");
Array.prototype.forEach.call(tabulka1,headerCell => {
    headerCell.addEventListener("click", () => {
    const tableElement =headerCell.parentElement.parentElement.parentElement ;
    const headerIndex = Array.prototype.indexOf.call(headerCell.parentElement.children, headerCell);
    const currentIsAscending = headerCell.classList.contains("th-sort-asc");
    sortTableByColumn(tableElement, headerIndex, !currentIsAscending);
    });
})
let tabulka2 = document.getElementById("LWT").getElementsByTagName("th");
Array.prototype.forEach.call(tabulka2,headerCell => {
    headerCell.addEventListener("click", () => {
    const tableElement =headerCell.parentElement.parentElement.parentElement ;
    const headerIndex = Array.prototype.indexOf.call(headerCell.parentElement.children, headerCell);
    const currentIsAscending = headerCell.classList.contains("th-sort-asc");
    sortTableByColumn(tableElement, headerIndex, !currentIsAscending);
    });
})
function rozinacG(){
    for(let i =0;i<TableQuestionsG.length;i++){
        row = TableQuestionsG[i];
        if (SlDChoose.value==row.getElementsByTagName("td")[0].textContent||SlDChoose.value=="none"){
            row.style.display="table-row";
        }
        else{
            row.style.display="none";
        }
    }
}
function rozinacW (){
    for(let i =0;i<TableQuestionsW.length;i++){
        row = TableQuestionsW[i];
        if (MChoose.value==row.getElementsByTagName("td")[0].textContent||MChoose.value=="none"){
            row.style.display="table-row";
        }
        else{
            row.style.display="none";
        }
    }
}
function filterResetW(){
    SlDChoose.value="none";
    rozinacW()
}
SlDChoose.addEventListener("change",rozinacG);
MChoose.addEventListener("change",rozinacW);
function changePage(x,max=""){
    lists = canvas.getElementsByClassName("list");
    if(x=="right"&&lists[CurrentPage]){
        for (let i=0;i<lists.length;i++){
            lists[i].style.display="none";
        }
        CurrentPage=max=="yes"?lists.length:CurrentPage+1;
        lists[CurrentPage-1].style.display="block";
        PageNumber.innerText=CurrentPage;
        LeftButton.classList.add("CanHover");
        LeftButton.classList.remove("CantHover");
        if(lists.length==CurrentPage){
            RightButton.classList.add("CantHover");    
            RightButton.classList.remove("CanHover");
        }
        document.getElementById("RemovePage").classList.add("CanHover");
        document.getElementById("RemovePage").classList.remove("CantHover");
    }
    else if(x=="left"&&CurrentPage!=1){
        for (let i=0;i<lists.length;i++){
            lists[i].style.display="none";
        }
        CurrentPage-=1;
        if(CurrentPage==1){
            LeftButton.classList.add("CantHover");
            LeftButton.classList.remove("CanHover");
            document.getElementById("RemovePage").classList.add("CantHover");
            document.getElementById("RemovePage").classList.remove("CanHover");
        }
        RightButton.classList.remove("CantHover");
        RightButton.classList.add("CanHover");
        lists[CurrentPage-1].style.display="block";
        PageNumber.innerText=CurrentPage;
    }
}
function DoSmWithPage(x){

    if(x=="A"){
        let a=`
            <div class="list">
                <div class="content" style="height:calc(100% - 14px)"></div>
            </div>
        `;
        canvas.insertAdjacentHTML("beforeend",a);
        changePage("right","yes");
    }
    else if(x=="R"){
        let lists = canvas.getElementsByClassName("list")
        if(document.getElementById("firstPage")!=lists[CurrentPage-1]){
            lists[CurrentPage-1].remove();
            changePage("left");
        }else{
            alert("První stránku nemůžeš vymazat");
        }
    }

}
$('[contenteditable]').on('paste', function(e) {
    var $self = $(this);
    setTimeout(function() {
    $self.html($self.text());
    }, 0);
}).on('keypress', function(e){
        return e.which != 13;
});
function showSavedTests(){
    document.getElementById("preparedTest").style.display="block";
}
function deleteSPT(){
    $.post("/Germany", {
        submit_button:"REMOVETEST",
        idtest:CurrentPTest
    });
    document.getElementById("areYouSure").style.display="none";
    document.getElementById(CurrentPTest).style.display="none";
    document.getElementById("tlacitko-"+CurrentPTest).style.display="none";

}
function exitSPT(){
    document.getElementById("preparedTest").style.display="none";
}
function showPT(e){
    Array.from(document.getElementsByClassName("PTest")).forEach(function(element){
        element.style.display="none"
    });
    document.getElementById(e).style.display="block";
    document.getElementById("deleteSPT").style.opacity="1";
    document.getElementById("deleteSPT").onclick=ays;
    CurrentPTest=e;
}
function ays(){
    document.getElementById('areYouSure').style.display='block'
}
</script>
<!-- Draggable stuff -->
<script>
function drags(){
    let item= this;
    draggedItem =item;
    if(TypeOfTest=="FlashCards"){
        if(item.children[0].children[0].style.transform=="rotateY(0deg)"){
            item.children[0].children[1].style.display="none";
        }
        else{
            item.children[0].children[0].style.display="none";
        }
    }

    setTimeout(function () {
        item.style.display = 'none';
    }, 0)
}
function drage(){
    if(TypeOfTest=="FlashCards"){
        if(draggedItem.children[0].children[0].style.transform=="rotateY(0deg)"){
            draggedItem.children[0].children[1].style.display="block";
        }
        else{
            draggedItem.children[0].children[0].style.display="block";
        }
    }
    setTimeout(function () {
        draggedItem.style.display = 'block';
        draggedItem = null;
    }, 0);
}
function pD(e){
    e.preventDefault();
}
function drop(){
    if (draggedItem==balicekKaretSpatny){
            let x = balicekKaretSpatny.children.length;
            for(let i=0;i<x;i++){
                this.append(balicekKaretSpatny.children[0]);
            }
            balicekKaretSpatny.style.display="block";
            resetDecks();
            removeDrag([balicekKaretSpatny],[balicekKaretVyber]);
        }else{
            this.append(draggedItem);
        }
    
}
function enableDrag(ToDraw,PlaceToPut){
    let list_items = ToDraw;
    let lists = PlaceToPut;
    for (let i = 0; i < list_items.length; i++) {
        let item = list_items[i];
        item.setAttribute("draggable","true");
        item.addEventListener('dragstart',drags);
        item.addEventListener('dragend',drage);
        for (let j = 0; j < lists.length; j ++) {
            let list = lists[j];
            list.addEventListener('dragover',pD);
            list.addEventListener('dragenter',pD);
            list.addEventListener('drop',drop);
            
        }
    }
}
function removeDrag(ToDraw,PlaceToPut){
    let cards = ToDraw;
    let deck = PlaceToPut;
    for (let i = 0; i < cards.length; i++) {
        let item = cards[i];
        item.setAttribute("draggable","false");
        item.removeEventListener('dragstart',drags);
        item.removeEventListener('dragend',drage);
        for (let j = 0; j < deck.length; j ++) {
            let list = deck[j];
            list.removeEventListener('dragover',pD);
            list.removeEventListener('dragenter',pD);
            list.removeEventListener('drop',drop);
        }
    }
}
</script>
<!-- Flashcards -->
<script>
const balicekKaretVyber = document.getElementById("VYBER");
const balicekKaretSpatny = document.getElementById("SPATNY");
const balicekKaretDobry = document.getElementById("DOBRY");
const vyhodnoceni = document.getElementById("vyhodnoceni");
const flashinfo = document.getElementById("flashinfo");
// let kontrola;
// zde se připravuje balíček karet
function FlashcardsPreparing(){
    document.getElementById("vyber").onclick="";
    resetDecks();
    removeDrag(document.querySelectorAll('.karta'),document.querySelectorAll('.decks'));
    balicekKaretSpatny.innerText="";
    balicekKaretDobry.innerText="";
    balicekKaretVyber.innerText="";
    balicekKaretVyber.onclick=null;
    // dragRemove(balicekKaretSpatny);
    // dragRemove(document.getElementById("vyber"));
    flashinfo.innerText="";
    for(let i=0;i<CurrentVocabulary[0];i++){
        let karta = document.createElement("div");
        let centralizer = document.createElement("div");
        let textb = document.createElement("p");
        let textf = document.createElement("p");
        let front = document.createElement("div");
        let back = document.createElement("div");
        karta.setAttribute("class","karta");
        centralizer.setAttribute("class","textcentralizer");
        karta.appendChild(centralizer);
        
        karta.setAttribute("onclick","rotatecard()");
        karta.setAttribute("draggable","true");

        textf.setAttribute("class","KartaText");
        textf.appendChild(document.createTextNode(CurrentVocabulary[1][i]));
        textb.setAttribute("class","KartaText");
        textb.appendChild(document.createTextNode(CurrentVocabulary[2][i]));
        
        front.setAttribute("class","card-side front");
        front.setAttribute("style","transform:rotateY(0deg)");
        back.setAttribute("class","card-side back");
        back.setAttribute("style","transform:rotateY(-180deg)");
        back.appendChild(textb);
        front.appendChild(textf);
        
        centralizer.appendChild(front);
        centralizer.appendChild(back);
        karta.setAttribute("onclick","rotatecard(this)");
        karta.setAttribute("id",i);
        balicekKaretVyber.appendChild(karta);
    };

    enableDrag(document.querySelectorAll('.karta'),document.querySelectorAll('.decks'));

    
    kontrola = new MutationObserver(function(mutations){
        if (balicekKaretVyber.children.length==0){
            vyhodnoceni.innerText=Math.round(balicekKaretDobry.children.length/CurrentVocabulary[0]*100)+"%";
            balicekKaretSpatny.onmouseover=function(){
                flashinfo.innerText="Willst du deine Fehler korrigieren?";
                document.getElementById("spatny").style.border="rgb(130,0,0) solid 10px";
                document.getElementById("spatny").style.cursor="pointer";
            };
            balicekKaretSpatny.onmouseout=function(){
                flashinfo.innerText="";
                document.getElementById("spatny").style.border="rgb(160,22,22) solid 10px";
                document.getElementById("spatny").style.cursor="auto";
            };
            document.getElementById("vyber").onmouseover=function(){
                flashinfo.innerText="Möchtest du das Kartendeck wiederholen?";
                document.getElementById("vyber").style.border="rgb(100, 100, 100) solid 10px";
                document.getElementById("vyber").style.cursor="pointer";
            }
            document.getElementById("vyber").onmouseout=function(){
                flashinfo.innerText="";
                document.getElementById("vyber").style.border="rgb(126, 126, 126) solid 10px";
                document.getElementById("vyber").style.cursor="auto";
            }
            document.getElementById("vyber").setAttribute("onclick","FlashcardsPreparing()");
            removeDrag(document.querySelectorAll('.karta'),document.querySelectorAll('.decks'));
            enableDrag([balicekKaretSpatny],[balicekKaretVyber]);
            enableDrag(balicekKaretVyber.children,document.querySelectorAll('.decks'))
        };
    })
    kontrola.observe(balicekKaretVyber,config);
    
};
// otáčí kartu o 180°
function rotatecard(t){
    let front = t.getElementsByClassName("front")[0];
    let back = t.getElementsByClassName("back")[0];
    if (back.style.transform=="rotateY(0deg)"){
        front.style.transform="rotateY(0deg)"
        back.style.transform="rotateY(-180deg)"            
    }else{
        front.style.transform="rotateY(180deg)"
        back.style.transform="rotateY(0deg)"
    }
}
// obnovuje výchozí nastavení balíčků
function resetDecks(){
    balicekKaretSpatny.onmouseover="";
    balicekKaretSpatny.onmouseout="";
    document.getElementById("vyber").onmouseover="";
    document.getElementById("vyber").onmouseout="";
    document.getElementById("vyber").style.border="rgb(126, 126, 126) solid 10px";
}
//hlídá jestli se má flashinfo zobrazit nebo ne
let flashinfokontrola = new MutationObserver(function(){
    if (flashinfo.innerText==""){
        flashinfo.style.visibility="hidden";
    }
    else {
        flashinfo.style.visibility="visible";
    };
}) ;
flashinfokontrola.observe(flashinfo,config);
//hlídá počet karet v balíčku "výběr"
let CardsLeft = new MutationObserver(function(){
    vyhodnoceni.innerHTML=balicekKaretVyber.children.length;
});
CardsLeft.observe(balicekKaretVyber,config);

</script>
{%endblock%}