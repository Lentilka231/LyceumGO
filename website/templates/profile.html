{%extends "baselog.html"%}
{%block title%}Profil{% endblock %}
{%block head%}
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/profile.css')}}">
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/zarovnavac.css')}}">
{%endblock%}
{%block content%}
<div id="flex-container">
<div id="Info">
    <div id="user">
        <img src="{{url_for('static',filename='images/Incognito.png')}}" class="UserImg">
        <div id="info">
            <form method="POST">
            <p style="font-size: 36px;"><b>{{user.name}}</b></p>
            <p class="information">Email: {{user.email}}</p>
            {%if user.person=="s"%}
                <p class="information">Ročník: {{user.grade}}</p>
            {%else%}
                <p class="information">Učitel</p>
            {%endif%}
            <p class="information">Oblíbený předmět:
                <select name="FS" id="FS">
                    {%for i in ["","Němčina","Informatika","Programování"]%}
                        <option value="{{i}}"{%if user.favouritesub==i %}selected{%endif%}>{{i}}</option>
                    {%endfor%}
                </select>
            </p>
            {%if classroom%}<p class="information">Třída: {{classroom}}</p>{%endif%}
                <textarea maxlength="1000" name="note" class="Inputs" id="ProfileAboutMe">{%if user.notes%}{{user.notes}}{%endif%}</textarea>
                <button type="submit" name="submit_button"value="save" id="save" class="BasicButton" style="display:none">Uložit</button>
            </form>
        </div>
    </div>
    <div id="userstats">
        <div id="aktivita">
        </div>
        <div id="help">?</div>
        <div class="statistics">
            Němčina
            <div class="progres">
                Progres: <div class="ProgresBar"><div id=NPlnitko></div></div>
            </div>
        </div>
        <div class="statistics">
            Informatika
            <div class="progres">
                Progres: <div class="ProgresBar"><div id=INFPlnitko></div></div>
            </div>
        </div>
        <div class="statistics">
            Programování
            <div class="progres">
                Progres: <div class="ProgresBar"><div id=PRGPlnitko></div></div>
            </div>
        </div>
    </div>
    <script>
        const a="{{user.activity}}".split("/");
        const myDate = new Date();
        const days=["Po","Út","St","Čt","Pá","So","Ne"];
        function sleep(ms){
            return new Promise(resolve => setTimeout(resolve,ms))
        };
        async function aktivita () {
            for(let i=0;i<7;i++){
                document.getElementById("aktivita").innerHTML+=`
                <div class="day">
                    ${a[i]=="T"?"":"<img src='{{url_for('static',filename='images/BFire.png')}}'>"} 
                    <p>${myDate.getDay()+i>6?days[myDate.getDay()+i-7]:days[myDate.getDay()+i]}</p>
                </div>`;
                await sleep(200)
                }
        }
        aktivita();
        document.getElementById("FS").addEventListener("change",function(){
            document.getElementById("save").style.display="block"
        })
        document.getElementById("ProfileAboutMe").addEventListener("change",function (){
            document.getElementById("save").style.display="block"
        })
        document.getElementById("NPlnitko").style.width="{{NJ.progress}}%";
        document.getElementById("INFPlnitko").style.width="{{INF.progress}}%";
        document.getElementById("PRGPlnitko").style.width="{{PRG.progress}}%";
    </script>
</div>
</div>
{% endblock %}