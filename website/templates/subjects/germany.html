{%extends "baselog.html"%}
{%block title%}Němčina{% endblock %}
{%block head%}
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/subject.css')}}">
<link rel= "stylesheet" type= "text/css" href="{{url_for('static', filename='/stylesheets/subjects/germany.css')}}">

{%endblock%}
{%block content%}

<div id="MainDiv">
<div id="flex-container">
<div class="flex-items first">
    <div id="NAME"><b>Němčina</b></div>
    <div class="decorator" >
        <div class="scroler">
            <div id="subclassinfo">
                <p>Třída: {{subclass.classroomname}}</p>
                <p>Progres: {{subclass.progres}}</p>
                <div id="PVerb" onclick="visibilator('PVerb','','')"  style="cursor:pointer;">
                    Verb/Slovesa
                </div>
            </div>
        </div>
        <div class="bsetings">
            <input type="checkbox" id="chvilkanakontrolu"> <label for="chvilkanakontrolu">dodatečný čas po odpovědi</label>
        </div>
    </div>
</div>
<div class="flex-items second">
    <div class="decorator">
        <div class="scroller">
            <div class="Module" id="M1" tabindex="1" style="background-color: rgb(115, 64, 155);">
                <p><b>1) Deutsch ist NICHT leicht!</b></p>
                <div class="child">
                    <p class="L" id="L3" >Lektion 1-3</p>
                </div>                
            </div>
            <div class="Module" id="M2" tabindex="1" style="background-color: orange;">
                <p><b>2) Hobbys und Schule</b></p>
                <div class="child">
                    <p class="L" id="L4">Lektion 4</p>
                    <p class="L" id="L5">Lektion 5</p>
                    <p class="L" id="L6">Lektion 6</p>
                </div> 
            </div>
            <div class="Module" id="M3" tabindex="1" style="background-color: rgb(153, 28, 126);">
                <p><b>3) Freizeit und Feiern</b></p>
                <div class="child">
                    <p class="L" id="L7">Lektion 7</p>
                    <p class="L" id="L8">Lektion 8</p>
                    <p class="L" id="L9">Lektion 9</p>
                </div>
            </div>
            <div class="Module" id="M4" tabindex="1" style="background-color: rgb(30, 150, 70);">
                <p><b>4) Essen, Einkaufen und Gesundheit</b></p>
                <div class="child">
                    <p class="L" id="L10">Lektion 10</p>
                    <p class="L" id="L11">Lektion 11</p>
                    <p class="L" id="L12">Lektion 12</p>
                </div>
            </div>
            <div class="Module" id="M5" tabindex="1" style="background-color: rgb(74, 101, 160);">
                    <p><b>5) Module 5</b></p>
                <div class="child">
                    <p class="L" id="L13">Lektion 13</p>
                    <p class="L" id="L14">Lektion 14</p>
                    <p class="L" id="L15">Lektion 15</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="flex-items third">
    <div class="decorator">
        <div class="scroller">
            <div id="DIVL3">
                <div class="DIVchild" id="gramatik" style="background-color: rgb(185, 120, 185);">
                    <b class="nadpisChild">Gramatik</b>
                    <div class="Material">
                        <div class="Block b11"onclick="visibilator('3','g',1)">
                            <b>Verbkonjugation im Präsens</b><br>
                            Časování sloves v přítomném čase
                        </div>
                        <div class="Block b11"onclick="visibilator('3','g',2)">
                            <b>Unbestimmte und bestimmte Artikel</b><br>
                            Neurčité a určitě členy
                        </div>
                        <div class="Block b11"onclick="visibilator('3','g',3)">
                            <b>Possessivartikel</b><br>
                            Přivlasťnovací zájmena
                        </div>
                    </div>
                </div>
                <div class="DIVchild" id="wortschatz" style="background-color: rgb(157, 101, 201);">
                    <b class="nadpisChild">Wortschatz</b>
                    <div class="Material">
                        {%for i,v in NJ1["lekce3"]["words"].items()%}
                        <div class="Block b12" onclick="visibilator('3','w','{{i}}')">
                            <b>{{i}}</b>
                            <div class="celkemwort">
                                {{v[0]}}
                            </div>
                        </div>
                        {%endfor%}
                        
                    </div>
                </div>
                <div class="DIVchild" id="lesen" style="background-color: rgb(93, 84, 164);">
                    <b class="nadpisChild">Lesen</b>
                    <div class="Material">
                        <div class="Block b13" onclick="visibilator('l','1')">
                            <b>Text1</b><br>
                            Hallo Leute!
                        </div>
                        <div class="Block b13" onclick="visibilator('l','2')">
                            <b>Text2</b><br>
                            Heute habe ich nicht Geburstag.
                        </div>
                        <div class="Block b13" onclick="visibilator('l','3')">
                            <b>Text3</b><br>
                            Prag ist teuer.
                        </div>
                        <div class="Block b13" onclick="visibilator('l','4')">
                            <b>Text4</b><br>
                            Meine Familie ist groß.
                        </div>
                    </div>
                </div>
                <div class="DIVchild" id="endtest" style="background-color: rgb(54, 80, 136);">
                    <b class="nadpisChild">Tests</b>
                </div>
            </div>
        </div>

    </div>
</div>
<!------------------------------------------------------------------------------------------------------------>
<div id="TestDiv">
    <div class="krizek" onclick="hider()" tabindex=3 style="z-index: 2;">✕</div>
    <div id="TDContent">
        <div class="task W">
            <div class=""></div>
        </div>
        <div class="task ABCD">
            <div class="questions">
                <b id="nzABCD" class="nzadani">Wählst du die (richtige) Antwort, wenigstens versuchst du es.</b><br>
                <p id="czABCD" class="czadani">Vyber (správnou) odpověď, alespoň to zkus.</p>
            </div>
            <div class="answer">
                <p id="FrantaABCD" class="Franta"></p>
                <div class="centralizer" style="bottom:30px;">
                    <div class="ABCDodpovedi">
                        <button type="button" id="A" onclick="checkanswer('A')">Odpoved A</button>
                        <button type="button" id="B" onclick="checkanswer('B')">Odpoved B</button>
                        <button type="button" id="C" onclick="checkanswer('C')">Odpoved C</button>
                        <button type="button" id="D" onclick="checkanswer('D')">Odpoved D</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="task X">
            <div class="questions">
                <b id="nzX" class="nzadani">Schreibst du die (richtige) Antwort.</b><br>
                <p id="czX" class="czadani">Napiš (správnou) odpověď.</p>
            </div>
            <div class="answer">
                <p id="FrantaX" class="Franta"></p>
                
                <div class="centralizer" style="bottom: 150px;">
                    <div id="XP">
                        <input type="text" id="X" spellcheck="false">
                    </div>
                </div>
                <div class="centralizer" style="bottom: 70px;">
                    <button type="button" onclick="checkanswer('X')" id="kontrola" style="margin-top:50px;">Kontroll</button>
                </div>
            </div>
        </div>
        <div class="congratulation">
            <div style="display:flex;flex-direction:column;justify-content:center;align-items: center;position: absolute;width: 100%;height: 100%;">
                <p style="font-size: 42px;"><b>Gratulation zum Bestehen der Prüfung</b></p>
                <p style="font-size:30px;">Gratuluji k dokončení testu:</p><br>
                <p>Erfolgsquote / úspěšnost:</p><br>
                <p style="font-size: 100px;"id="procenta"></p>
            </div>
        </div>
        <div class="w xPVerb">
            <table>
                <tr>
                    <th>id</th>
                    <th>slovíčko</th>
                </tr>
                <tr><td>1</td><td>haben</td></tr>
                <tr><td>[cislo]</td><td>[sloveso]</td></tr>
            </table>
        </div>
        <div class="w x3g1">
            <p class="nnadpis"><b>Verbkonjugation im Präsens</b></p>
            <p class="cnadpis">Časování sloves v přítomném čase</p>
            <div class="g">
                <table id="VK">
                    <tr><th></th><th colspan="2">pravidelná slovesa</th><th colspan="3">nepravidelná slovesa</th></tr>
                    <tr><th>infinitiv</th><td>spielen</td><td>trinken</td><td>haben</td><td>sein</td><td>essen</td></tr>
                    <tr><th>ich</th><td>spiel<span>e</span></td><td>trink<span>e</span></td><td>hab<span>e</span></td><td><span>bin</span></td><td>ess<span>e</span></td></tr>
                    <tr><th>du</th><td>spiel<span>st</span></td><td>trink<span>st</span></td><td><span>hast</span></td><td><span>bist</span></td><td><span>isst</span></td></tr>
                    <tr><th>er/sie/es</th><td>spiel<span>t</span></td><td>trink<span>t</span></td><td><span>hat</span></td><td><span>ist</span></td><td><span>isst</span></td></tr>
                    <tr><th>wir</th><td>spiel<span>en</span></td><td>trink<span>en</span></td><td>hab<span>en</span></td><td>sind</td><td>ess<span>en</span></td></tr>
                    <tr><th>ihr</th><td>spiel<span>t</span></td><td>trink<span>t</span></td><td>hab<span>t</span></td><td>seid</td><td>ess<span>t</span></td></tr>
                    <tr><th>sie/Sie</th><td>spiel<span>en</span></td><td>trink<span>en</span></td><td>hab<span>en</span></td><td><span>sind</span></td><td>ess<span>en</span></td></tr>
                </table>
            </div>
            <p class="didyouknow">Věděliste, že v němčině při vykání vlastně "onikáme".</p>
            <div class="cara"> </div>
            <div class="b">
                <p class="ntext"><b>Übungen:</b></p>
                <p class="ctext">Cvičení:</p>
                <div class="t easyt" onclick="tp('ABCD','3','grammar','1')">leichter Test</div>
                <div class="t hardt" onclick="tp('X','3','grammar','1')">schwieriger Test</div>
            </div>
        </div>
        <div class="w x3g2">asdasd</div>
        <div class="w x3g3">asdasd</div>

        <div class="w xs">
            <b><div id="strana"></div></b>
            <div class="sgrid">
                <div id="slovicka">
                    <table id='slovnicek'>
                    </table>
                </div>
                <div class="gridchild Flashcards" onclick="">
                    Flashcards
                </div>
                <div class="gridchild WritingČ">
                    Psaní<br>
                    němčina<br>
                    ↓<br>
                    čeština
                </div>
                <div class="gridchild WritingN">
                    Psaní<br>
                    čeština<br>
                    ↓<br>
                    němčina
                </div>
                <div class="gridchild Matches">
                    Spojování
                </div>
            </div>
        </div>

        <div class="w x3l1">nbmgzu</div>
        <div class="w x3l2">hgkignmb</div>
        <div class="w x3l3"></div>

        <div class="w x3t1"></div>
        <div class="w x3t2"></div>
        <div class="w x3t3"></div>
    </div>
</div>
</div>
</div>
<script>
    //vše týkající se zviditelňování
     $(document).ready(function(){
        const a = [false,false,false,false,false]
        const x = document.querySelectorAll(".Module");
        const child = document.querySelectorAll(".child");
        const L = document.querySelectorAll(".L")
        // tohle zobrazuje Lektiony 1-15 v modulech
        for(let i=1;i<6;i++){
            $("#M"+i).click(function(){
                if (!(a[i-1]) ){
                    for (let y=0;y<5;y++){
                        a[y]=false;
                        child[y].style.display="none";
                    };
                    a[i-1]=true;
                    child[i-1].style.display="block";
                }
                else{
                    a[i-1]=false;
                    child[i-1].style.display="none";
                };                 
            });
        };
        $("#TDContent").children().hide()
        //pracujou s rozklikáváním jednotlivých modelů
        for (let i=3;i<16;i++){
            $("#DIVL"+i).hide()
        }
        
        for(let i=3;i<L.length;i++){
            $("#L"+i).click(function(e){
                for(let i=0;i<L.length;i++){
                        L[i].style.color="black"
                }
                for (let i=3;i<16;i++){
                    $("#DIVL"+i).hide()
                }
                e.stopPropagation();
                if($("#DIVL"+i).is(":visible")){
                    
                    document.getElementById("L"+i).style.color="black";
                    $("#DIVL"+i).hide()
                }
                else{
                    document.getElementById("L"+i).style.color="gray";
                    $("#DIVL"+i).show()                
                }

            })
        }
        });
    // Vše týkající se testů 
    const NJ = JSON.parse('{{ NJ1 | tojson | safe }}');
    var questions;
    var momentalQuestion;
    var typetest;
    var task;
    var uspesnost =[];
    var z;
    var XTest=false;
    function visibilator(lekce,typ,ukol){
        $("#TestDiv").show();
        if (typ=="w"){
            cw=NJ["lekce"+lekce]["words"][ukol];
            slovicka=""
            document.getElementById("slovnicek").innerHTML="<tr><th>id</th><th>německy</th><th>česky</th></tr>";
            for(var i=0;i<cw[0];i++){
                slovicka+="<tr><td>"+(i+1)+"</td><td>"+cw[1][i]+"</td><td>"+cw[2][i]+"</td></tr>";
            };
            document.getElementById("slovnicek").innerHTML+=slovicka;
            document.getElementById("strana").innerHTML=ukol;
            $(".xs").show();
        }
        else{
            $(".x"+lekce+typ+ukol).show();
        }
    };
    function hider(){
        $("#TestDiv").hide();
        $("#TDContent").children().hide();
        $(".task").hide();
        $(".congratulation").hide();
        c=["A","B","C","D"];
        for(let i=0;i<4;i++){
            document.getElementById(c[i]).style.border="solid 3px rgb(189, 213, 234)";
        }
        document.getElementById("XP").style.border="none";
        document.getElementById("X").value="";
        XTest=false;

    };
    function endOfTest(){
        $(".task").hide();
        
        for(let i=0;i<uspesnost.length;i++){
            z+=uspesnost[i];
        };
        document.getElementById("procenta").innerHTML=Math.round(z/uspesnost.length*100)+"%";
        $(".congratulation").show();

    };
    function sleep(ms){
        return new Promise(resolve => setTimeout(resolve,ms))
    };
    document.onkeypress = function (e) {
        if(e.key=="Enter" & XTest){
            checkanswer("X")
        };
    };
    async function checkanswer (x){
        switch(typetest){
            case "ABCD":
                a=document.getElementById(x)
                if (task.otazky[momentalQuestion].a==a.innerHTML){
                    a.style.border="solid rgb(25, 146, 61) 3px";
                    questions.splice(questions.indexOf(momentalQuestion),1);
                    if(document.getElementById("chvilkanakontrolu").checked){
                        await sleep(1000);
                    }
                    c=["A","B","C","D"];
                    for(let i=0;i<4;i++){
                        document.getElementById(c[i]).style.border="solid 3px rgb(189, 213, 234)";
                    }
                    XTest=false;
                    newquestion()
                }
                else{
                    uspesnost[momentalQuestion]=0;
                    a.style.border="solid red 3px";
                }
                break;
            case "X":
                if (task.otazky[momentalQuestion].a==document.getElementById("X").value){
                    questions.splice(questions.indexOf(momentalQuestion),1);
                    document.getElementById("XP").style.border="rgb(25, 146, 61) solid 3px";

                    if(document.getElementById("chvilkanakontrolu").checked){
                        await sleep(1000);
                    }
                    document.getElementById("XP").style.border="none";
                    document.getElementById("X").value="";
                    newquestion()
                }
                else{
                    document.getElementById("XP").style.border="red solid 3px";
                    uspesnost[momentalQuestion]=0;
                }
                break;

        }
    };
    function newquestion (){
        if (questions.length>0){
            do{
                a=Math.floor(Math.random()*task.otazky.length);   
            }
            while(!questions.includes(a));
            switch(typetest){
                case "ABCD":
                    document.getElementById("nzABCD").innerHTML=task.zadaniN;
                    document.getElementById("czABCD").innerHTML=task.zadaniC;
                    document.getElementById("FrantaABCD").innerHTML=task.otazky[a]["q"];
                    b=["a","1","2","3"];
                    c=["A","B","C","D"];
                    for (let i=0;i<4;i++){
                        d=Math.floor(Math.random()*(3-i));
                        document.getElementById(c[i]).innerHTML=task.otazky[a][b[d]];
                        b.splice(d,1);
                    };
                    break;
                case "X":
                    XTest=true;
                    document.getElementById("nzX").innerHTML=task.zadaniN;
                    document.getElementById("czX").innerHTML=task.zadaniC;
                    document.getElementById("FrantaX").innerHTML=task.otazky[a]["q"];
                    break;
            };
            momentalQuestion=a;
        }
        else{
            endOfTest();
        };
    };
    function tp(type,k,t,x){
        $(".w").hide();
        $("."+type).show();
        questions =Array.from({length:NJ["lekce"+k][t][x].otazky.length}, (_, i) => i);
        uspesnost =Array.from({length:NJ["lekce"+k][t][x].otazky.length},(_,i) => 1);
        task=NJ["lekce"+k][t][x];
        typetest=type;
        z=0
        newquestion();
    };
</script>
{%endblock%}